/*
@license
Webix SpreadSheet v.4.1.0
This software is covered by Webix Trial License.
Usage without proper license is prohibited.
(c) XB Software Ltd.
*/
!function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return e[o].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="/codebase/",t(0)}([function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}n(11),n(12);var i=n(28),r=o(i),a=n(34),s=o(a),l=n(40),u=o(l),c=n(41),d=o(c),f=n(43),h=o(f),p=n(45),v=o(p),w=n(56),m=o(w),g=n(57),b=n(79),_=n(94),x=o(_),y=n(95);n(96);var C={name:"spreadsheet",_base_index:{count:1},defaults:{spans:!0,rowCount:50,math:!0,columnCount:20,resizeCell:!0,sheetTabWidth:90,conditionStyle:(0,y.getDefaultStyles)()},$init:function(){this.$index=this._base_index.count++,this.$view.className+=" webix_ssheet",this.$ready.unshift(this._sub_init),this.$ready.push(this._set_handlers)},_sub_init:function(){var e=this.config,t=[];!e.readonly&&e.menu&&t.push(x.init(this)),e.readonly||e.toolbar===!1||t.push(r.init(this)),e.subbar&&t.push(e.subbar),e.liveEditor&&t.push(d.init(this)),t.push(s.init(this,{editable:!e.readonly,spans:!0,clipboard:e.clipboard,liveEditor:e.liveEditor})),e.bottombar&&(e.bottombar===!0?t.push(h.init(this)):t.push(e.bottombar)),e.readonly||(m.init(this),v.init(this)),this.rows_setter(t)},_set_handlers:function(){var e=this;this._table||(this._table=this.$$("cells"),(0,g.operations)(this),s.reset(this,this.config.columnCount,this.config.rowCount),u.init(this),this._table.attachEvent("onAfterAreaAdd",function(){return e.callEvent("onAfterSelect",[e.getSelectedId(!0)])}),this.callEvent("onComponentInit",[]))},$onLoad:function(e,t){if(this._set_handlers(),e.excel){var n=e.options||{};n.math=this.config.math,e=t.getSheet(e,n),e=this._excel_to_data(e)}h.load(this,e)},_excel_to_data:function(e){for(var t=webix.copy(e.data||e),n=[],o=0;o<t.length;o++)for(var i=0;i<t[0].length;i++){var r=o+1,a=i+1;n.push([r,a,t[o][i]])}if(e.spans)for(var o=0;o<e.spans.length;o++)e.spans[o][0]++,e.spans[o][1]++;return e.data?e.data=n:e={data:n},e},$exportView:function(e){return webix.extend(e,{header:!1,rawValues:!0,spans:!0,xCorrection:1,yCorrection:1}),this._table}};(0,b.api)(C),webix.protoUI(C,webix.AtomDataLoader,webix.IdSpace,webix.ui.layout)},,,,,,,,,,,function(e,t){"use strict";webix.i18n.spreadsheet={labels:{common:"Common",currency:"Currency",number:"Number",percent:"Percent","undo-redo":"Undo/Redo",font:"Font",text:"Text",cell:"Cell",align:"Align",format:"Number",column:"Column",borders:"Borders",px:"px",apply:"Apply",cancel:"Cancel",save:"Save",sheet:"Sheet","conditional-format":"Conditional Format",condition:"Condition","conditional-value":"Value","conditional-style":"Style",range:"Range","range-title":"Named ranges","range-name":"Name","range-cells":"Range","image-or":"or","image-title":"Add image","image-upload":"Select file for upload","image-url":"URL (e.g. http://*)","sparkline-title":"Add sparkline","sparkline-type":"Type","sparkline-range":"Range","sparkline-color":"Color","sparkline-positive":"Positive","sparkline-negative":"Negative","format-title":"Set format","format-pattern":"Format pattern","dropdown-title":"Add dropdown","dropdown-range":"Range",ok:"OK","import-title":"Import","import-not-support":"Sorry, your browser does not support import","export-title":"Export","export-name":"Name of xslx file","link-title":"Add Link","link-name":"Text","link-url":"URL",image:"Image",graph:"Graph",display:"Display",value:"Value","range-remove-confirm":"Are you sure you want to remove the range permanently?","sheet-remove-confirm":"Are you sure you want to remove the sheet permanently?","error-range":"The range is incorrect!"},tooltips:{color:"Font color",background:"Background color","font-family":"Font family","font-size":"Font size","text-align":"Horizontal align","vertical-align":"Vertical align",borders:"Borders","borders-no":"Clear borders","borders-left":"Left border","borders-top":"Top border","borders-right":"Right border","borders-bottom":"Bottom border","borders-all":"All borders","borders-outer":"Outer borders","borders-top-bottom":"Top and bottom borders","borders-color":"Border color","align-left":"Left align","align-center":"Center align","align-right":"Right align","align-top":"Top align","align-middle":"Middle align","align-bottom":"Bottom align",span:"Merge",wrap:"Text wrap",undo:"Undo",redo:"Redo",format:"Number format","font-weight":"Bold","font-style":"Italic","text-decoration":"Underline","hide-gridlines":"Hide/show gridlines","hide-headers":"Hide/show headers","freeze-columns":"Freeze/unfreeze columns","add-range":"Set name for the selected range",conditional:"Conditional formatting","add-sheet":"Add Sheet","lock-cell":"Lock/unlock cell","clear-styles":"Clear styles","add-link":"Add link",row:"Rows",column:"Columns",sheet:"Sheet"},menus:{"remove-sheet":"Remove sheet","rename-sheet":"Rename sheet",file:"File","new":"New","new-sheet":"New sheet","excel-import":"Import from Excel","excel-export":"Export to Excel",sheet:"Sheets","copy-sheet":"Copy to new sheet",edit:"Edit",undo:"Undo",redo:"Redo",columns:"Columns","insert-column":"Insert column","delete-column":"Delete column","show-column":"Show column","hide-column":"Hide column",rows:"Rows","insert-row":"Insert row","delete-row":"Delete row","show-row":"Show row","hide-row":"Hide row",insert:"Insert","conditional-format":"Conditional format","clear-styles":"Clear styles","add-image":"Image","add-sparkline":"Graph",data:"Data","add-link":"Add link","add-range":"Named ranges",sort:"Sort","sort-asc":"Sort A to Z","sort-desc":"Sort Z to A","create-filter":"Create filter",view:"View","freeze-columns":"Freeze/unfreeze columns","freeze-rows":"Freeze/unfreeze rows","hide-gridlines":"Hide/show gridlines","hide-headers":"Hide/show headers","add-dropdown":"Add dropdown","custom-format":"Custom format","lock-cell":"Lock/unlock cell"}}},function(e,t,n){"use strict";n(13),n(14),n(15),n(16),n(17),n(18),n(19),n(20),n(21),n(23),n(24),n(25),n(26),n(27)},function(e,t){"use strict";webix.protoUI({name:"ssheet-align",$cssName:"richselect",$init:function(e){e.options={view:"datasuggest",body:{view:"ssheet-icons",tooltip:{template:"#tooltip#"},xCount:3,yCount:1},data:e.data}}},webix.ui.richselect)},function(e,t){"use strict";webix.protoUI({name:"ssheet-borders-suggest",defaults:{width:300},$init:function(e){e.body={margin:6,cols:[{view:"ssheet-icons",scroll:!1,select:!0,xCount:4,yCount:2,tooltip:{template:function(e){return webix.i18n.spreadsheet.tooltips["borders-"+e.id]}},on:{onAfterSelect:function(e){var t=this.getParentView().getParentView();t.updateMasterValue(!0)}},template:function(e){var t="webix_ssheet_button_icon webix_ssheet_icon_borders_"+e.value;return"<span class='"+t+"'></span>"},data:e.data},{view:"ssheet-separator"},{rows:[{view:"ssheet-color",css:e.css,name:e.name,width:62,tooltip:webix.i18n.spreadsheet.tooltips["borders-color"],title:"<span class='webix_icon fa-pencil'></span>",on:{onChange:function(){var e=this.getParentView().getParentView().getParentView();e.updateMasterValue(!1)}}},{}]}]}},updateMasterValue:function(e){var t=this.getValue(),n=webix.$$(this.config.master);n.setValue(t),e&&this.hide()},setValue:function(e){e[0]&&this.getList().select(e[0]),e[1]&&this.getColorView().setValue(e[1])},getValue:function(){return[this.getList().getSelectedId(),this.getColorView().getValue()||""]},getList:function(){return this.getBody().getChildViews()[0]},getColorView:function(){return this.getBody().getChildViews()[2].getChildViews()[0]}},webix.ui.suggest),webix.protoUI({name:"ssheet-borders",$cssName:"richselect",defaults:{text:"<span class='webix_ssheet_button_icon webix_ssheet_icon_borders'>"},$init:function(e){e.options={view:"ssheet-borders-suggest",fitMaster:!1,data:e.data},this.$ready.push(webix.bind(function(){this.getPopup().config.master=this.config.id},this))},setValue:function(e){return webix.isArray(e)&&(this.config.value&&e[0]==this.config.value[0]&&e[1]==this.config.value[1]||this.getPopup().setValue(e),this.config.value=e,e[0]&&this.callEvent("onChange")),e},getValue:function(){return this.getPopup().getValue().join(",")},getList:function(){return this.getPopup().getBody().getChildViews()[0]},getColorView:function(){return this.getPopup().getBody().getChildViews()[1].getChildViews()[0]}},webix.ui.richselect)},function(e,t){"use strict";webix.protoUI({$cssName:"colorboard",name:"ssheet-colorboard",defaults:{css:"webix_ssheet_colorboard",palette:[["#000000","#434343","#666666","#999999","#b7b7b7","#cccccc","#d9d9d9","#efefef","#f3f3f3","#ffffff"],["#980000","#ff0000","#ff9900","#ffff00","#00ff00","#00ffff","#4a86e8","#0000ff","#9900ff","#ff00ff"],["#e6b8af","#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#c9daf8","#cfe2f3","#d9d2e9","#ead1dc"],["#dd7e6b","#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#a4c2f4","#9fc5e8","#b4a7d6","#d5a6bd"],["#cc4125","#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6d9eeb","#6fa8dc","#8e7cc3","#c27ba0"],["#a61c00","#cc0000","#e69138","#f1c232","#6aa84f","#45818e","#3c78d8","#3d85c6","#674ea7","#a64d79"],["#85200c","#990000","#b45f06","#bf9000","#38761d","#134f5c","#1155cc","#0b5394","#351c75","#741b47"],["#5b0f00","#660000","#783f04","#7f6000","#274e13","#0c343d","#1c4587","#073763","#20124d","#4c1130"]]},setValue:function(e){return e?("#"!=e.charAt(0)&&(e="#"+e),this.config.value=e,this.drawSelection(e),e):void 0},drawSelection:function(e,t){if(this.isVisible(this.config.id))for(var n=this.$view.lastChild.getElementsByTagName("DIV"),o=0;o<n.length;o++){var i=n[o].getAttribute("webix_val");i&&(i.toUpperCase()!=e.toUpperCase()?webix.html.removeCss(n[o],"webix_selected"):webix.html.addCss(n[o],"webix_selected",""))}}},webix.ui.colorboard),webix.protoUI({$cssName:"richselect",name:"ssheet-color",defaults:{css:"webix_ssheet_color",icon:"angle-down",suggest:{height:202,borderless:!0,body:{view:"ssheet-colorboard",on:{onSelect:function(e){this.getParentView().setMasterValue({value:e})}}}}},$init:function(){this.$view.className+=" webix_ssheet_color"},$renderInput:function(e,t,n){var o=this.renderColor.call(this);return t=t.replace(/([^>]>)(.*)(<\/div)/,function(t,n,i,r){return n+e.title+o+r}),webix.ui.colorpicker.prototype.$renderInput.call(this,e,t,n)},$setValue:function(e){var t=webix.$$(this.config.popup.toString()),n=t.getBody();e&&(n.setValue(e),this.config.value=e,this.getColorNode().style.backgroundColor=e)},renderColor:function(){return"<div class='webix_ssheet_cp_color' style='background-color:"+this.config.value+";'> </div>"},getColorNode:function(){return this.$view.firstChild.firstChild.childNodes[1]},$renderIcon:function(){return webix.ui.text.prototype.$renderIcon.apply(this,arguments)}},webix.ui.colorpicker)},function(e,t){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};webix.protoUI({$cssName:"window",name:"ssheet-dialog",$init:function(e){this.$view.className+=" webix_ssheet_dialog",this.config.buttons=e.buttons},getHeaderConfig:function(e){return{paddingX:10,paddingY:5,height:60,cols:[{view:"label",label:e},{view:"button",type:"htmlbutton",css:"close",label:"<span class='webix_ssheet_button_icon webix_ssheet_hide_icon'></span>",width:40,click:function(){var e=this.getTopParentView();e.callEvent("onHideClick",[])}}]}},getBodyConfig:function(e){e.borderless=!0;var t=this.getFormElements(e),n={view:"form",css:"webix_ssheet_form",paddingY:0,elements:t};return n},getFormElements:function(e){var t;return webix.isArray(e)?t=e:(t=[],t.push(e)),this.config.buttons&&(t.push({height:1}),t.push({margin:10,cols:[{},{view:"button",type:"cancel",label:webix.i18n.spreadsheet.labels.cancel,autowidth:!0,click:function(){var e=this.getTopParentView();e.callEvent("onCancelClick",[])}},{view:"button",label:webix.i18n.spreadsheet.labels.save,autowidth:!0,click:function(){var e=this.getTopParentView();e.callEvent("onSaveClick",[])}}]})),t.push({height:10,borderless:!0}),t},body_setter:function(e){return"object"==("undefined"==typeof e?"undefined":n(e))&&(e.paddingY=e.paddingY||0,"form"==e.view&&e.elements?(e.elements=this.getFormElements(e.elements),e.css||(e.css="webix_ssheet_form")):e=this.getBodyConfig(e)),webix.ui.window.prototype.body_setter.call(this,e)},head_setter:function(e){return e&&(e=this.getHeaderConfig(e)),webix.ui.window.prototype.head_setter.call(this,e)},defaults:{padding:0,move:!0,head:!0,buttons:!0,width:350}},webix.ui.window,webix.IdSpace),webix.protoUI({$cssName:"datatable",name:"ssheet-dialog-table",$init:function(e){e.headerRowHeight||(e.headerRowHeight=34),this.$view.className+=" webix_ssheet_table webix_ssheet_dialog_table"}},webix.ui.datatable)},function(e,t){"use strict";webix.protoUI({name:"ssheet-form-popup",defaults:{padding:0,borderless:!0},$init:function(){this.$view.className+=" webix_ssheet_form"}},webix.ui.suggest),webix.protoUI({name:"ssheet-form-suggest",defaults:{padding:0,borderless:!0},$init:function(){this.$view.className+=" webix_ssheet_suggest"}},webix.ui.suggest),webix.protoUI({$cssName:"colorpicker",name:"ssheet-colorpicker",$init:function(){this.$view.className+=" webix_ssheet_colorpicker"},defaults:{icon:"angle-down",suggest:{height:202,borderless:!0,body:{view:"ssheet-colorboard",on:{onSelect:function(e){this.getParentView().setMasterValue({value:e})}}}}}},webix.ui.colorpicker)},function(e,t){"use strict";webix.protoUI({name:"formlate",setValue:function(e){return this.setHTML(e)},getValue:function(){return""}},webix.ui.template)},function(e,t){"use strict";webix.protoUI({name:"ssheet-icons",$cssName:"dataview",$init:function(){this.$view.className+=" webix_ssheet_dataview"},defaults:{borderless:!0,template:"<span class='webix_ssheet_button_icon #css#' ></span>",type:{width:36,height:36}}},webix.ui.dataview)},function(e,t){"use strict";webix.protoUI({name:"ssheet-suggest",defaults:{padding:0,css:"webix_ssheet_suggest"}},webix.ui.contextmenu)},function(e,t,n){"use strict";n(22),webix.protoUI({name:"live-editor",$cssName:"text webix_ssheet_formula",defaults:{keyPressTimeout:25},$init:function(e){var t=this;e.suggest={view:"suggest-formula",data:e.suggestData},this.attachEvent("onKeyPress",function(e){13===e&&new Date-(t._last_value_set||0)>300&&(t.updateCellValue(),webix.UIManager.setFocus(t.getTopParentView().$$("cells")))})},updateCellValue:function(){var e=this.getValue(),t=this.getTopParentView(),n=this.config.activeCell;n?e!=t.getCellValue(n.row,n.column)&&(this.config.value=e,t.setCellValue(n.row,n.column,e),t.refresh()):this.setValue("")},$setValueHere:function(e){this.setValueHere(e)},setValueHere:function(e){this._last_value_set=new Date;var t=this.getInputNode(),n=t.value,o=t.selectionStart,i=n.substring(0,o),r=n.substring(o);i=i.replace(/([a-zA-Z\(]+)$/,e),t.value=i+"("+r,t.setSelectionRange(i.length+1,i.length+1)},expectRange:function(){var e=this.getValue().trim(),t=e.substr(e.length-1,1);return t.match(/[\(\,]/)},expectOperator:function(){var e=this.getValue().trim(),t=e.substr(e.length-1,1);return t.match(/[\+\-\/\*\%\=\(:\,]/)},setRange:function(e){var t=this.getInputNode(),n=t.selectionStart,o=this.getValue(),i=o.substring(0,n)+e,r=o.substring(n);t.value=i+r,t.setSelectionRange(i.length+1,i.length+1),this.focus()}},webix.ui.text)},function(e,t){"use strict";webix.protoUI({name:"suggest-formula",defaults:{fitMaster:!1,width:200,filter:function(e,t){var n=webix.$$(this.config.master).getInputNode(),o=n.selectionStart,i=n.value;if("="===i.charAt(0)){var r=i.substring(0,o).match(/([a-zA-Z]+)$/),a=i.charAt(o).search(/[^A-Za-z0-9]/);return!r||o!==i.length&&0!==a||(t=r[0]),0===e.value.toString().toLowerCase().indexOf(t.toLowerCase())}}},$init:function(){var e=this;this.attachEvent("onBeforeShow",function(t,n,o){if(t.tagName){var i=webix.html.offset(t),r=9,a=i.y+i.height,s=i.x+t.selectionStart*r;return webix.ui.popup.prototype.show.apply(e,[{x:s,y:a}]),!1}})},setMasterValue:function(e,t){var n=e.id?this.getItemText(e.id):e.text||e.value,o=webix.$$(this.config.master);o.setValueHere(n),t||this.hide(!0),this.callEvent("onValueSuggest",[e,n])},$enterKey:function(e){return e.isVisible()?webix.ui.suggest.prototype.$enterKey.apply(this,arguments):void 0}},webix.ui.suggest)},function(e,t){"use strict";webix.protoUI({name:"ssheet-separator",defaults:{css:"webix_ssheet_toolbar_spacer",template:" ",width:1,borderless:!0}},webix.ui.view)},function(e,t){"use strict";webix.protoUI({name:"sheets",defaults:{layout:"x",borderless:!0,css:"ssheet_list_sheets",scrollX:!1,select:!0,scroll:!1},getVisibleCount:function(){return Math.floor(this.$width/this.type.width)}},webix.EditAbility,webix.ui.list)},function(e,t){"use strict";webix.protoUI({$cssName:"toggle",name:"ssheet-toggle",toggle:function(){var e=this.getValue()==this.config.onValue;this.setValue(!e)},$setValue:function(e){e==this.config.offValue?e=!1:e==this.config.onValue&&(e=!0),webix.ui.toggle.prototype.$setValue.call(this,e)},getValue:function(){var e=this.config,t=e.value;return t&&t!=e.offValue?e.onValue||!0:e.offValue||!1},defaults:{template:function(e,t){var n=e.value===!0||e.value==e.onValue?" webix_pressed":"",o=t.$renderInput(e,t);return"<div class='webix_el_box"+n+"' style='width:"+e.awidth+"px; height:"+e.aheight+"px'>"+o+"</div>"}}},webix.ui.toggle)},function(e,t){"use strict";webix.protoUI({name:"ssheet-bar-title",defaults:{borderless:!0},$init:function(e){this.$view.className+=" webix_ssheet_subbar_title"}},webix.ui.template)},function(e,t){"use strict";function n(e){return{view:"ssheet-suggest",css:"webix_ssheet_suggest",autowidth:!0,template:function(e){var t="";return e.icon&&(t+="<span class='webix_ssheet_button_icon webix_ssheet_icon_"+e.icon+"'></span> "),t+=e.value||webix.i18n.spreadsheet.menus[e.id]||e.id},data:e,on:{onItemClick:function(e){var t=this.config.master;if(t){var n=webix.$$(t).getTopParentView(),o=[this.getItem(e)];if(webix.$$(t).config.area){var i=n.$$("cells").getSelectArea();i&&(o=o.concat([i.start,i.end]))}n.callEvent("onCommand",o)}}}}}webix.protoUI({name:"ssheet-button",$cssName:"button",defaults:{type:"htmlbutton",width:40},$init:function(e){if(this.$view.className+=" webix_ssheet_button",e.label||e.icon){var t=(e.icon||e.name).replace("-","_"),o=e.label||"";e.arrow&&(o+="<span class='webix_ssheet_button_icon webix_ssheet_icon_arrow fa fa-angle-down'></span>"),e.label="<span class='webix_ssheet_button_icon webix_ssheet_icon_"+t+"'></span> "+o,e.tooltip=webix.i18n.spreadsheet.tooltips[e.name]||""}e.options&&!e.popup&&(e.popup=n(e.options))}},webix.ui.button),webix.protoUI({name:"ssheet-button-icon-top",$cssName:"button",defaults:{type:"htmlbutton",width:70,height:70},$init:function(e){if(this.$view.className+=" ssheet_button_icon_top",e.label){var t=(e.icon||e.name||"").replace("-","_"),o=e.label;e.label="<span class='webix_ssheet_button_icon webix_ssheet_icon_"+t+"'></span><br/>",e.label+="<span class='ssheet_button_icon_top_text'>"+o+"</span>",e.arrow&&(e.label+="<br/><span class='ssheet_button_icon_top_arrow fa fa-angle-down'></span>"),e.tooltip=webix.i18n.spreadsheet.tooltips[e.name]||""}e.options&&!e.popup&&(e.popup=n(e.options))}},webix.ui.button)},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){e.attachEvent("onComponentInit",function(){return r(e)});var t=[];if(e.config.toolbar){var n=e.config.toolbar;"full"==n&&(n=c.getAllElements(),webix.isUndefined(e.config.bottombar)&&(e.config.bottombar=!0)),t=l.ui.toolbarElements(e,n)}else t=l.ui.getButtons(e,e.config.buttons||d);var o={view:"toolbar",css:"webix_ssheet_toolbar webix_layout_toolbar",id:"bar",padding:0,elements:t,on:{onChange:function(){var t=this.$eventSource,n=t.getValue(),o=t.config.name;e.callEvent("onStyleSet",[o,n])},onItemClick:function(t){var n=e.innerId(t);s.actions[n]?s.actions[n].call(this,e):e.callEvent("onCommand",[{id:n}])}}};return e.callEvent("onViewInit",["toolbar",o]),o}function r(e){e.attachEvent("onAfterSelect",function(t){return a(e,t)})}function a(e,t){var n={},o=t[0];if(o){var i=e.getStyle(o.row,o.column);i&&(n=i.props)}webix.extend(n,l.defaultStyles),e.$$("bar").setValues(n)}t.__esModule=!0,t.init=i;var s=n(29),l=n(30),u=n(33),c=o(u),d={"undo-redo":["undo","redo"],font:["font-family","font-size","font-weight","font-style","text-decoration","color","background","borders"],align:["text-align","vertical-align","wrap","span"],format:["format"]}},function(e,t){"use strict";function n(e,t){var n,o,i=t.start,r=t.end;for(n=1*i.row;n<=1*r.row;n++)for(o=1*i.column;o<=1*r.column;o++)if(e.$$("cells").getSpan(n,o))return!0;return!1}t.__esModule=!0;t.actions={span:function(e){var t=e.$$("cells").getSelectArea();t&&(n(e,t)?e.splitCell():e.combineCells())},undo:function(e){e.undo()},redo:function(e){e.redo()},"hide-gridlines":function(e){e.hideGridlines()},"hide-headers":function(e){e.hideHeaders()},"freeze-columns":function(e){var t=e.$$("cells"),n=t.getSelectedId();e.freezeColumns(n&&"rowId"!=n.column?n.column:0)},"lock-cell":function(e){e.callEvent("onCommand",[{id:"lock-cell"}])},"freeze-rows":function(e){var t=e.$$("cells"),n=t.getSelectedId();e.freezeRows(n?n.row:0)},"create-filter":function(e){e.callEvent("onCommand",[{id:"create-filter"}])},"conditional-format":function(e){e.callEvent("onCommand",[{id:"conditional-format"}])},"clear-data":function(e){e.clearRange()}}},function(e,t,n){"use strict";t.__esModule=!0,t.ui=t.defaultStyles=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},i=n(31),r={height:39,margin:7,paddingY:1,sectorPadding:5,sectorMargin:0},a=[{id:"no",value:"no"},{id:"left",value:"left"},{id:"top",value:"top"},{id:"right",value:"right"},{id:"bottom",value:"bottom"},{id:"all",value:"all"},{id:"outer",value:"outer"},{id:"top-bottom",value:"top_bottom"}],s=t.defaultStyles={color:"#000000",background:"#ffffff","font-family":"'PT Sans', Tahoma","font-size":"15px","text-align":"left","vertical-align":"top","white-space":"nowrap",borders:["no","#434343"]},l=t.ui={toolbarElements:function(e,t){var n=function o(t){for(var n=0;n<t.length;n++){var r=t[n].$button;if(r){var a=i.buttonsMap[r]?i.buttonsMap[r](e):l.iconButton({name:r});webix.extend(t[n],a)}t[n].rows&&o(t[n].rows),t[n].cols&&o(t[n].cols)}};return n(t),t},getButtons:function(e,t){var n=[];for(var o in t)n.push(l.elementsBlock(e,o,t[o])),n.push(l.separator());return n},elementsBlock:function(e,t,n){var o={rows:[{padding:2,cols:[{height:r.height,margin:2,cols:l.blockColumns(e,n)}]},l.title({title:t})]};return o},blockColumns:function(e,t){for(var n=[],r=0;r<t.length;r++){var a=t[r];if("object"==("undefined"==typeof a?"undefined":o(a)))n.push(a);else{var s=i.buttonsMap[a]?i.buttonsMap[a](e):l.iconButton({name:a});n.push(s)}}return n},button:function(e){return{view:"ssheet-toggle",width:e.width||40,id:e.name,name:e.name,label:e.label,css:e.css||"",onValue:e.onValue,offValue:e.offValue,tooltip:webix.i18n.spreadsheet.tooltips[e.name]||""}},colorButton:function(e){return{view:"ssheet-color",css:e.css,name:e.name,width:e.width||62,title:"<span class='webix_ssheet_button_icon webix_ssheet_color_button_icon webix_ssheet_icon_"+e.name.replace(/-/g,"_")+"' ></span>",tooltip:webix.i18n.spreadsheet.tooltips[e.name]||""}},iconButton:function(e){var t=webix.copy(e);return webix.extend(t,{view:"button",type:"htmlbutton",width:40,id:e.name,label:"<span class='webix_ssheet_button_icon webix_ssheet_icon_"+e.name.replace(/-/g,"_")+"'></span>",css:"",tooltip:webix.i18n.spreadsheet.tooltips[e.name]||webix.i18n.spreadsheet.menus[e.name]||""}),e.onValue&&webix.extend(t,{view:"ssheet-toggle",onValue:e.onValue,offValue:e.offValue},!0),t},segmented:function(e){return{view:"segmented",name:e.name,css:e.css||"",width:e.width||115,options:e.options}},select:function(e){return webix.extend(e,{view:"richselect",id:e.name,value:s[e.name],suggest:{css:"webix_ssheet_suggest",padding:0,data:e.options}}),e.tooltip=webix.i18n.spreadsheet.tooltips[e.name]||"",e.popupWidth&&(e.suggest.fitMaster=!1,e.suggest.width=e.popupWidth),e.popupTemplate&&(e.suggest.body={template:e.popupTemplate}),e},separator:function(){return{view:"ssheet-separator"}},title:function u(e){var u=e.title;return 0===u.indexOf("$")&&(u=""),u=webix.i18n.spreadsheet.labels[e.title]||u,{template:u,view:"ssheet-bar-title",height:24}},borders:function(e){return{view:"ssheet-borders",width:e.width||62,data:a,id:e.name,name:e.name,tooltip:webix.i18n.spreadsheet.tooltips[e.name]}},align:function(e){return{view:"ssheet-align",value:s[e.name],width:e.width||62,data:e.options,name:e.name,tooltip:webix.i18n.spreadsheet.tooltips[e.name]}},condFormat:function(e){return{view:"ssheet-cond-format",width:40,id:e.name,name:e.name}}}},function(e,t,n){"use strict";function o(){var e=webix.i18n.spreadsheet.labels;return[{id:"-1",value:e.common},{id:"price",value:e.currency,example:"98.20"},{id:"int",value:e.number,example:"2120.02"},{id:"percent",value:e.percent,example:"0.5"}]}function i(){var e=webix.i18n.spreadsheet.menus;return[{id:"add",group:"column",value:e["insert-column"]},{id:"del",group:"column",value:e["delete-column"]},{id:"show",group:"column",value:e["show-column"]},{id:"hide",group:"column",value:e["hide-column"]}]}function r(){var e=webix.i18n.spreadsheet.menus;return[{id:"add",group:"row",value:e["insert-row"]},{id:"del",group:"row",value:e["delete-row"]},{id:"show",group:"row",value:e["show-row"]},{id:"hide",group:"row",value:e["hide-row"]}]}function a(){for(var e=["8","9","10","11","12","14","15","16","18","20","22","24","28","36"],t=[],n=0;n<e.length;n++)t.push({id:e[n]+webix.i18n.spreadsheet.labels.px,value:e[n]});return t}t.__esModule=!0,t.buttonsMap=void 0;var s=n(30),l=n(32),u=[{id:"Arial",value:"Arial"},{id:"'PT Sans', Tahoma",value:"PT Sans"},{id:"Tahoma",value:"Tahoma"},{id:"Verdana",value:"Verdana"}];t.buttonsMap={"font-family":function(){return s.ui.select({name:"font-family",tooltip:"Font family",options:u,width:100})},"font-size":function(){return s.ui.select({name:"font-size",tooltip:"Font size",options:a(),width:62})},"font-weight":function(){return s.ui.button({name:"font-weight",label:"B",css:"webix_ssheet_bold",tooltip:"Bold",onValue:"bold",offValue:"normal"})},"font-style":function(){return s.ui.button({name:"font-style",label:"I",css:"webix_ssheet_italic",tooltip:"Italic",onValue:"italic",offValue:"normal"})},"text-decoration":function(){return s.ui.button({name:"text-decoration",label:"U",css:"webix_ssheet_underline",tooltip:"Underline",onValue:"underline",offValue:"normal"})},color:function(){return s.ui.colorButton({name:"color",icon:"font",css:"webix_ssheet_color"})},background:function(){return s.ui.colorButton({name:"background",icon:"paint-brush",css:"webix_ssheet_background"})},borders:function(){return s.ui.borders({name:"borders"})},"text-align":function(){var e=webix.i18n.spreadsheet.tooltips;return s.ui.align({name:"text-align",tooltip:"Horizontal Align",css:"webix_ssheet_align",options:[{id:"left",css:"webix_ssheet_icon_left",tooltip:e["align-left"]},{id:"center",css:"webix_ssheet_icon_center",tooltip:e["align-center"]},{id:"right",css:"webix_ssheet_icon_right",tooltip:e["align-right"]}]})},"vertical-align":function(){var e=webix.i18n.spreadsheet.tooltips;return s.ui.align({name:"vertical-align",tooltip:"Vertical Align",css:"webix_ssheet_align",options:[{id:"top",css:"webix_ssheet_icon_top",tooltip:e["align-top"]},{id:"middle",css:"webix_ssheet_icon_middle",tooltip:e["align-middle"]},{id:"bottom",css:"webix_ssheet_icon_bottom",tooltip:e["align-bottom"]}]})},wrap:function(){return s.ui.iconButton({name:"wrap",onValue:"wrap",offValue:"nowrap"})},format:function(e){return s.ui.select({name:"format",tooltip:"Cell data format",options:o(),width:100,popupWidth:180,popupTemplate:function(e){var t=l.formatHelpers[e.id];return e.value+(t?"<span class='webix_ssheet_right'>"+t(e.example)+"</span>":"")}})},column:function(){return{name:"column",view:"ssheet-button",icon:"column",arrow:!0,area:!0,width:55,options:i()}},row:function(){return{name:"row",view:"ssheet-button",icon:"row",arrow:!0,area:!0,width:55,options:r()}}}},function(e,t){"use strict";function n(e,t){var n,o=[];for(n in v)o.push([n,v[n]]);t.formats=o}function o(e,t){var n,o=t.formats;if(o)for(n=0;n<o.length;n++)a(o[n][1],o[n][0])}function i(e){return p[e]}function r(e){return v[e]||""}function a(e,t){return w[e]?w[e]:(t=t||"fmt"+h++,f[t]=e,p[t]=l(e),v[t]=e,w[e]=t,t)}function s(e){var t=e.match(/.*\[[><=].*/g),n=e.split(";");return t||n.length>1&&(n[0]=(n.length>2?"[>=0]":"[>0]")+n[0],n[1]="[<0]"+n[0],n[2]&&(n[2]="[=0]"+n[0])),n}function l(e){for(var t=s(e),n=[],o=0;o<t.length;o++){var i="",r="",a=t[o],l=a.indexOf("[");if(-1!==l&&a[1].match(/[><=]/)){var c=a.indexOf("]");i=a.substr(l+1,c-l-1),a=a.substr(c+1)}if(l=a.indexOf("["),-1!==l){var c=a.indexOf("]");r=a.substr(l+1,c-l-1),a=a.substr(c+1)}n.push(u(i,r,a,o))}return new Function("val","extra",n.join("\n")+" return val;")}function u(e,t,n,o){var i="";return e&&(i+=o?"else if":"if","="===e[0]&&(e="="+e),i+="(val"+e+"){ "),t&&(i+='extra.css = "webix_ssheet_format_'+t+'";'),i+=c(n),i+(e?"}":"")}function c(e){if(!e)return"return val;";for(var t=0,n='return ""',o="",i=!1,r=!1,a=0;a<e.length;a++){if('"'==e[a]){if(t){n+='+"'+e.substr(t,a-t)+'"',t=!1;continue}t=a}t||("."===e[a]?o+=".":"0"===e[a]||"#"===e[a]||"?"===e[a]?(r||(n+="+fmt",r=!0),o+=e[a]):","===e[a]?i=!0:n+='+"'+e[a]+'"')}return o?d(o,i)+";"+n+";":n+";"}function d(e,t){var n="if (isNaN(val)) var fmt = val; else {",o=e.split("."),i=o[0],r=o[1];r=(r||"").split("").reverse().join("");var a=i.indexOf("0");a>=0&&(a=i.length-a);var s=i.indexOf("?");s>=0&&(s=i.length-s);var l=r.indexOf("0");l>=0&&(l=r.length-l);var u=Math.max(l,r.length),c=r.indexOf("?");return c>=0&&(c=r.length-c),n+="\n	var decimal = '.';\n	var parts = val.toFixed("+u+').split(decimal);\n	var left = parts[0];\n	var lsize = left.length; \n	var right = parts[1] || "";\n	if (left.length < '+a+') left = "0000000000".substr(0, '+a+" - left.length)+left;\n	if (left.length < "+s+') left = "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;".substr(0, 6*('+s+" - left.length))+left;\n	if ("+t+') { \n		var buf = [];\n		var start = 3;\n		while (lsize > start) { buf.push(left.substr(left.length-start,3)); start+=3; }\n		buf.push(left.substr(0,left.length-start+3)); \n		left = buf.reverse().join(",");\n	}\n	if (right){\n		var zpoint = right.length; for (var i=right.length-1; i>=0; i--) if (right[i]!="0"){ zpoint = right.length-i; break; }\n	\n		if (zpoint >  '+l+")\n			right = right.substr(0,"+l+");\n		if (right.length < "+c+') left += "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;".substr(0, 6*('+c+' - left.length));\n	}\n	var fmt = left+(right?decimal:"")+right;',n+"}\n"}t.__esModule=!0,t.serialize=n,t.load=o,t.getFormat=i,t.getFormatSource=r,t.addFormat=a;var f={},h=0,p=t.formatHelpers={price:function(e){return webix.i18n.priceFormat(e)},"int":function(e){return webix.i18n.numberFormat(e)},percent:function(e){return Math.round(100*e)+"%"}},v={},w={}},function(e,t){"use strict";function n(e){var t=webix.i18n.spreadsheet;return t.menus[e]||t.labels[e]||t.tooltips[e]||e}function o(){var e,t,o,i={undo:["undo","redo"],insert:["add-sparkline","add-image"]},r={};for(t in i)for(r[t]=0,e=0;e<i[t].length;e++)o=webix.html.getTextSize(n(i[t][e]),"webix_ssheet_button_measure").width+2,r[t]=Math.max(o,r[t]);return r}function i(){var e=o();return[{padding:3,margin:0,rows:[{margin:2,cols:[{name:"sheet",view:"ssheet-button-icon-top",label:n("sheet"),arrow:!0,options:[{id:"new-sheet"},{id:"copy-sheet"},{id:"remove-sheet"}]},{rows:[{$button:"excel-import"},{$button:"excel-export"}]}]},{},{template:n("file"),view:"ssheet-bar-title",height:24,width:85}]},{view:"ssheet-separator"
},{padding:3,rows:[{$button:"undo",view:"ssheet-button",label:n("undo"),width:e.undo},{$button:"redo",view:"ssheet-button",label:n("redo"),width:e.undo},{template:n("undo-redo"),view:"ssheet-bar-title",height:24}]},{view:"ssheet-separator"},{padding:3,rows:[{margin:2,cols:[{margin:2,cols:[{$button:"font-family",width:124},{$button:"font-size"}]},{$button:"borders"}]},{margin:2,cols:[{margin:2,cols:[{$button:"font-weight"},{$button:"font-style"},{$button:"text-decoration"}]},{$button:"background"},{$button:"color"}]},{template:n("font"),view:"ssheet-bar-title",height:24}]},{view:"ssheet-separator"},{padding:3,rows:[{margin:2,cols:[{$button:"text-align"},{$button:"span"}]},{margin:2,cols:[{$button:"vertical-align"},{$button:"wrap"}]},{template:n("align"),view:"ssheet-bar-title",height:24}]},{view:"ssheet-separator"},{padding:3,rows:[{$button:"format"},{$button:"custom-format"},{template:n("number"),view:"ssheet-bar-title",height:24}]},{view:"ssheet-separator"},{padding:3,rows:[{cols:[{$button:"sort-asc"},{$button:"create-filter"},{$button:"conditional-format"},{$button:"add-link"},{$button:"clear-styles"}]},{cols:[{$button:"sort-desc"},{$button:"add-range"},{$button:"lock-cell"},{$button:"add-dropdown"}]},{template:n("edit"),view:"ssheet-bar-title",height:24}]},{view:"ssheet-separator"},{padding:3,rows:[{$button:"add-image",view:"ssheet-button",label:n("image"),width:e.insert},{$button:"add-sparkline",view:"ssheet-button",label:n("graph"),width:e.insert},{template:n("insert"),view:"ssheet-bar-title",height:24}]},{view:"ssheet-separator"},{padding:3,rows:[{cols:[{rows:[{$button:"row"},{$button:"column"}]},{rows:[{$button:"hide-gridlines"},{$button:"hide-headers"}]},{rows:[{$button:"freeze-rows"},{$button:"freeze-columns"}]}]},{template:n("view"),view:"ssheet-bar-title",height:24}]},{view:"ssheet-separator"},{}]}t.__esModule=!0,t.getAllElements=i},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t){e.attachEvent("onComponentInit",function(){return r(e)});var n={view:"datatable",id:"cells",css:"webix_ssheet_table wss_"+e.$index,headerRowHeight:20,spans:!0,leftSplit:1,areaselect:!0,editable:!0,editaction:t.liveEditor?"custom":"dblclick",navigation:!0};return"undefined"==typeof t.clipboard&&(t.clipboard=!0),t&&(n=webix.extend(n,t,!0)),n}function r(e){var t=e._table;e.config.math&&(t.config.editMath=!0),t.attachEvent("onBeforeEditStop",function(n,o){n.old===webix.undefined&&""===n.value||(n.value!=n.old&&(e.setCellValue(o.row,o.column,n.value),t.refresh()),n.value=n.old)});var n=void 0;t.$view.firstChild.addEventListener("mousedown",function(e){n=e.path[1].cellIndex+1}),t.$view.firstChild.addEventListener("mouseup",function(t){var o=t.path[1].cellIndex+1;n&&n!==o&&(d.selectColumn(n,e,o),n=void 0)}),e.attachEvent("onBeforeEditStart",function(t,n){return!e.isCellLocked(t,n)}),t.attachEvent("onBeforeEditStart",function(t){return e.callEvent("onBeforeEditStart",[t.row,t.column])}),t.attachEvent("onBeforeSelect",function(e){return"rowId"!=e.column}),t.attachEvent("onBeforeBlockSelect",function(e,t,n){return!n||"rowId"===e.column&&"rowId"===t.column||("rowId"===e.column&&(e.column=1),"rowId"===t.column&&(t.column=1)),"rowId"!==e.column||"rowId"!==t.column}),t.attachEvent("onItemDblClick",function(t){"rowId"===t.column&&d.adjustRow(t.row,e)});var o=0;t.attachEvent("onHeaderClick",function(t,n){var i=new Date-o<=300;i?d.adjustColumn(t.column,e):n.shiftKey?d.selectColumns(t.column,e):d.selectColumn(t.column,e)}),t.attachEvent("onAfterBlockSelect",function(t,n){"rowId"===t.column&&"rowId"===n.column&&d.selectRows(null,e)}),t.attachEvent("onItemClick",function(t,n){"rowId"===t.column&&(n.shiftKey?d.selectRows(t.row,e):d.selectRow(t.row,e))}),e.attachEvent("onReset",function(t){return s(e,t)}),t.attachEvent("onBlur",function(){webix.delay(function(){var n=document.activeElement;if(!n||"INPUT"!=n.tagName){var o=webix.UIManager.getFocus(),i=o&&o!=t&&o.getTopParentView&&o.getTopParentView()===e;i&&webix.UIManager.setFocus(t)}},this,[],100)}),u(e)}function a(e,t,n,o,i){var r=t.$cellFormat?t.$cellFormat[i.id]:null;if(r){var a={css:""},s=v.getFormat(r);if(s){var l=parseFloat(o);if(!isNaN(l)){var u=s(l,a);return a.css?"<div class='"+a.css+"'>"+u+"</div>":u}}}return o}function s(e,t){var n=e.$$("cells"),o=n.getSelectArea();n.clearAll();for(var i=e.config.columnCount,r=e.config.rowCount,s=[{id:"rowId",header:"",width:40,css:"sheet_column_0",template:function(e){return e.id}}],l=1;i>=l;l++)s.push({id:l,editor:"text",header:{text:h.encode[l],css:e._hideColumn&&e._hideColumn.indexOf(l+1)>=0?"webix_ssheet_hide_column":""},template:function(t,n,o,i){return a(e,t,n,o,i)}}),e.callEvent("onColumnInit",[s[l]]);n.refreshColumns(s),e._hideColumn&&e._hideColumn.length&&e._hideColumn.map(function(e){return n.hideColumn(e)});for(var u=[],l=1;r>=l;l++)u.push({id:l});n.parse(u),e._hideRow&&e._hideRow.length&&n.filter(function(t){if(-1===e._hideRow.indexOf(t.id))return!0;if(t.id-1===0){var n=e.$$("cells").getColumnConfig("rowId").header[0];n.css=(n.css||"")+" webix_ssheet_hide_row",e.$$("cells").refreshColumns()}else e.$$("cells").addCellCss(t.id-1,"rowId","webix_ssheet_hide_row");return!1}),o&&t&&t.select&&o.end.row<=r&&o.end.column<=i&&n.addSelectArea(o.start,o.end)}function l(e){var t=e._table,n=t.getAllSelectAreas();for(var o in n){var i=n[o];t.addSelectArea(i.start,i.end,!0,o)}}function u(e){webix.html.addStyle("#"+e._table.$view.id+".webix_dtable .webix_cell { white-space:nowrap;}")}t.__esModule=!0,t.init=i,t.reset=s,t.updateSelectAreas=l;var c=n(35),d=o(c),f=n(39),h=o(f),p=n(32),v=o(p)},function(e,t,n){"use strict";function o(e,t,n){var o={row:e,column:1},i={row:n||e,column:t.config.columnCount};s(o,i,t)}function i(e,t,n){var o=t.$$("cells").data.order[0],i=t.$$("cells").data.order.length,r={row:o,column:e},a={row:i,column:n||e};s(r,a,t)}function r(e,t){var n=t.$$("cells").getSelectArea();n?o(n.start.row,t,n.end.row):o(e,t)}function a(e,t){var n=t.$$("cells").getSelectArea();if(n){var o=Math.min(n.start.column,n.end.column,e),r=Math.max(n.start.column,n.end.column,e);i(o,t,r)}else i(e,t)}function s(e,t,n){n.$$("cells").addSelectArea(e,t)}function l(e,t){var n=25;t._table.eachRow(function(o){var i=this.getItem(o),r=this.getText(o,e),a=t.getStyle(o,e),s=a?a.id:"";if(r){var l=(0,c.getTextSize)(t,r,s,0,i.$height);l.width>n&&(n=l.width)}}),t._table.setColumnWidth(e,n)}function u(e,t){var n=25;t._table.eachColumn(function(o){var i=this.getText(e,o),r=t.getStyle(e,o),a=r?r.id:"";if(i){var s=(0,c.getTextSize)(t,i,a,this.getColumnConfig(o).width,0);s.height>n&&(n=s.height)}}),t._table.setRowHeight(e,n)}t.__esModule=!0,t.selectRow=o,t.selectColumn=i,t.selectRows=r,t.selectColumns=a,t.adjustColumn=l,t.adjustRow=u;var c=n(36)},function(e,t,n){"use strict";function o(e){e.attachEvent("onStyleSet",function(t,n){return c(e,t,n)}),e.attachEvent("onDataParse",function(t){return u(e,t)}),e.attachEvent("onDataSerialize",function(t){return s(e,t)}),e.attachEvent("onReset",function(){return i(e)}),e.attachEvent("onUndo",function(t,n,o,i){"style"==t&&a(e,n,o,i)}),e.attachEvent("onCommand",function(t){"clear-styles"==t.id&&e.clearRange(null,{styles:!0})}),i(e),C||(C=webix.html.create("DIV",{style:"visibility:hidden; position:absolute; top:0px; left:0px; overflow:hidden;"},""))}function i(e){e._styles={},e._styles_cache={},e._styles_max=0;var t=".wss_"+e.$index;webix.html.removeStyle(t)}function r(e,t){var n=e.getRow(t.row).$cellCss;if(n){var o=n[t.column];if(o)return e._styles[o]}return null}function a(e,t,n,o){var i={row:t,column:n};p(e,i,o)}function s(e,t){var n=[];for(var o in e._styles_cache)n.push([e._styles_cache[o].id,o]);t.styles=n}function l(e,t,n){var o={props:x(";;;;;;;;;;;;;;;")};if(n)for(var i in n.props)o.props[i]=n.props[i];for(var r in t)o.props[r]=t[r];o.text=_(o);var a=e._styles_cache[o.text];return a?a:(b(e,o),o)}function u(e,t){if(t.styles)for(var n=0;n<t.styles.length;n++){var o=t.styles[n],i={id:o[0],text:o[1],props:x(o[1])};b(e,i,!0),e._styles[i.id]=i}for(var n=0;n<t.data.length;n++){var r=t.data[n],a=r[0],s=r[1],l=r[3];l&&h(e.getRow(a),s,e._styles[l])}}function c(e,t,n){$.group.set(function(){e.eachSelectedCell(function(o){d(e,o,t,n)})}),e.refresh()}function d(e,t,n,o){var i=r(e,t),a=f(e,i,n,o,t);a&&a!=i&&m(e,t,a,i)}function f(e,t,n,o,i){if(M[n])return M[n](e,t,o,i);if(t&&t.props[n]==o)return t;var r={text:"",id:0,props:t?webix.copy(t.props):{}};r.props[n]=o,r.text=_(r);var a=e._styles_cache[r.text];return a?a:(b(e,r),r)}function h(e,t,n){e.$cellCss=e.$cellCss||{},e.$cellFormat=e.$cellFormat||{},n?(e.$cellCss[t]=n.id,e.$cellFormat[t]=n.props.format||null):(delete e.$cellCss[t],delete e.$cellFormat[t])}function p(e,t,n){var o=r(e,t);return m(e,t,n,o)}function v(e,t,n){t=(0,S.rangeObj)(t,e);for(var o=t.start.row;o<=t.end.row;o++)for(var i=t.start.column;i<=t.end.column;i++)p(e,{row:o,column:i},n)}function w(e,t,n,o,i){var r=0,a=0;return C.innerHTML=t,C.style.width=(o||1)+"px",C.style.height=(i||1)+"px",C.className="webix_table_cell webix_cell "+n,e._table.$view.appendChild(C),r=Math.max(r,C.scrollWidth),a=Math.max(a,C.scrollHeight),e._table.$view.removeChild(C),C.innerHTML="",{width:r,height:a}}function m(e,t,n,o){e.callEvent("onBeforeStyleChange",[t.row,t.column,n,o])&&(n&&(e._styles[n.id]=n),h(e.getRow(t.row),t.column,n),e.saveCell(t.row,t.column),e.callEvent("onStyleChange",[t.row,t.column,n,o]))}function g(e){var t="";for(var n in e)e[n]&&(V[n]?V[n][e[n]]?t+=V[n][e[n]](e):"function"==typeof V[n]&&(t+=V[n](e)):t+=n+":"+e[n]+";");return t}function b(e,t,n){e._styles_max++,e._styles_cache[t.text]=t,t.id=t.id||"wss"+e._styles_max;var o=g(t.props),i=".wss_"+e.$index;webix.html.addStyle(i+" ."+t.id+"{"+o+"}",i),n||e._save("styles",{name:t.id,text:t.text})}function _(e){for(var t=[],n=0;n<E.length;n++)t.push(e.props[E[n]]);return t.join(";")}function x(e){for(var t=e.split(";"),n={},o=0;o<E.length;o++)n[E[o]]=t[o];return n}function y(e,t){t=(0,S.rangeObj)(t,e),$.group.set(function(){for(var n=t.start.row;n<=t.end.row;n++)for(var o=t.start.column;o<=t.end.column;o++){var i={row:n,column:o},a=r(e,i);e.callEvent("onBeforeStyleClear",[n,o,a])&&a&&p(e,{row:n,column:o},null)}})}t.__esModule=!0,t.init=o,t.getStyle=r,t.addStyle=l,t.setStyle=p,t.setRangeStyle=v,t.getTextSize=w,t.clearRangeStyle=y;var C,$=n(37),S=n(39),E=["color","background","text-align","font-family","font-size","font-style","text-decoration","font-weight","vertical-align","wrap","borders","format","border-right","border-bottom","border-left","border-top"],V={"vertical-align":{top:function(){return"display: block;"},middle:function(e){var t="flex-start";"center"==e["text-align"]?t="center":"right"==e["text-align"]&&(t="flex-end");var n="display: flex; align-items: center;justify-content:"+t+";";return n},bottom:function(e){var t="flex-start";"center"==e["text-align"]?t="center":"right"==e["text-align"]&&(t="flex-end");var n="display: flex; align-items:flex-end;justify-content:"+t+";";return n}},wrap:{wrap:function(){return"white-space: normal !important; line-height:normal !important; padding-top:7px;padding-bottom:7px;"},nowrap:function(){return""}},format:"",borders:"","border-left":function(e){return e["border-left"]?"border-left: 1px solid "+e["border-left"]+" !important;":""},"border-top":function(e){return e["border-top"]?"border-top: 1px solid "+e["border-top"]+" !important;":""},"border-right":function(e){return e["border-right"]?"border-right: 1px solid "+e["border-right"]+" !important;":""},"border-bottom":function(e){return e["border-bottom"]?"border-bottom: 1px solid "+e["border-bottom"]+" !important;":""}},k={"border-left":function(e,t,n){return e.column==t.start.column||"no"==n},"border-right":function(e,t,n){return e.column==t.end.column||"all"==n||"no"==n},"border-top":function(e,t,n){return e.row==t.start.row||"no"==n},"border-bottom":function(e,t,n){return e.row==t.end.row||"all"==n||"no"==n}},M={borders:function(e,t,n,o){var i=e.$$("cells").getSelectArea();n=n.split(",");var r=n[0],a=n[1],s=["border-left","border-right","border-bottom","border-top"];"no"==r?a="":"top-bottom"==r?s=["border-top","border-bottom"]:"all"!=r&&"outer"!=r&&(s=["border-"+r]);for(var l=0;l<s.length;l++){var u=s[l],c=e.callEvent("onAction",["check-borders",{row:o.row,column:o.column,area:i,type:r,mode:u}]);(c===!0||k[u](o,i,r))&&(t=f(e,t,u,a,o))}return t}}},function(e,t,n){"use strict";function o(e){a(e),d(e),e.attachEvent("onHardReset",function(){return a(e)}),e.attachEvent("onSheetShow",function(){return a(e)}),e.attachEvent("onBeforeStyleChange",function(t,n,o,i){return(0,f.isCellLocked)(e,t,n)?!1:void s(e,{action:"style",row:t,column:n,value:i,newValue:o,group:h.value})}),e.attachEvent("onBeforeValueChange",function(t,n,o,i){return(0,f.isCellLocked)(e,t,n)?!1:void s(e,{action:"value",row:t,column:n,value:i,newValue:o,group:h.value})}),e.attachEvent("onBeforeSpan",function(t,n,o){return(0,f.isCellLocked)(e,t,n)?!1:void s(e,{action:"span",row:t,column:n,value:o,newValue:o,group:h.value})}),e.attachEvent("onBeforeSplit",function(t,n,o){return(0,f.isCellLocked)(e,t,n)?!1:void s(e,{action:"split",row:t,column:n,value:o,newValue:o,group:h.value})}),e.attachEvent("onAction",function(t,n){return s(e,{action:t,row:n.row||null,column:n.column||null,value:n.value||null,newValue:n.newValue||null,group:h.value})}),e.$$("cells").attachEvent("onColumnResize",function(t,n,o){return s(e,{action:"c-resize",row:0,column:t,value:o,newValue:n})}),e.$$("cells").attachEvent("onRowResize",function(t,n,o){return s(e,{action:"r-resize",row:t,column:0,value:o,newValue:n})}),e.attachEvent("onBeforeConditionSet",function(t,n,o,i){return(0,f.isCellLocked)(e,t,n)?!1:(o=o?webix.copy(o):null,void s(e,{action:"condition",row:t,column:n,value:o,newValue:i,group:h.value}))})}function i(e){c(e,-1)}function r(e){c(e,1)}function a(e){p||(e._ssUndoHistory=[],e._ssUndoCursor=-1)}function s(e,t){e.$skipHistory||(e._ssUndoHistory.splice(e._ssUndoCursor+1),e._ssUndoHistory.push(t),e._ssUndoCursor++)}function l(e,t){t.$skipHistory=!0,e(),t.$skipHistory=!1}function u(e){p=!0,e(),p=!1}function c(e,t){var n=e._ssUndoHistory[t>0?e._ssUndoCursor+t:e._ssUndoCursor];if(n){var o=t>0?n.newValue:n.value,i=t>0,r=[n.action,n.row,n.column,o,i];e._ssUndoCursor+=t;var a=n.group,s=e._ssUndoHistory[t>0?e._ssUndoCursor+t:e._ssUndoCursor];l(function(){e.callEvent("onUndo",r),a&&s&&a==s.group||e.refresh()},e),s&&a&&a==s.group&&c(e,t)}}function d(e){e.attachEvent("onUndo",function(t,n,o,i){switch(t){case"freeze-row":e.freezeRows(i);break;case"freeze-column":e.freezeColumns(i)}})}t.__esModule=!0,t.group=void 0,t.init=o,t.undo=i,t.redo=r,t.reset=a,t.ignoreUndo=l,t.ignoreReset=u;var f=n(38),h=t.group={value:null,set:function(e,t){this.value?e.call(t):(this.start(),e.call(t),this.end())},start:function(){this.value=webix.uid()},end:function(){this.value=null}},p=!1},function(e,t,n){"use strict";function o(e){e._locks={},e.attachEvent("onReset",function(){return i(e)}),e.attachEvent("onUndo",function(t,n,o,i){"lock"===t&&r(e,n,o,!!i,!0)}),e.attachEvent("onCommand",function(t){"lock-cell"===t.id&&c(e)}),e.attachEvent("onAction",function(e,t){"before-grid-change"==e&&d(t.name,t.inc,t.data,t.start)})}function i(e){e._locks={}}function r(e,t,n,o,i){var s=e.$$("cells");if("object"===("undefined"==typeof t?"undefined":f(t))&&"object"===("undefined"==typeof n?"undefined":f(n)))h.group.set(function(){a(t,n,function(t,n){r(e,t,n,o,!0)})});else{o=o!==!1;var l=e._locks[t]=e._locks[t]||{};l[n]=o,o?s.addCellCss(t,n,p,!0):s.removeCellCss(t,n,p,!0),e.callEvent("onAction",["lock",{row:t,column:n,value:!o,newValue:o}])}i||s.refresh()}function a(e,t,n,o){for(var i=e.row;i<=t.row;i++)for(var r=e.column;r<=t.column;r++)n.call(o||this,i,r)}function s(e,t,n){return e._locks[t]?e._locks[t][n]:!1}function l(e,t){var n,o,i=[];for(n in e._locks)for(o in e._locks[n])e._locks[n][o]&&i.push([n,o]);t.locked=i}function u(e,t){var n,o=t.locked;if(o)for(n=0;n<o.length;n++)r(e,o[n][0],o[n][1],!0)}function c(e){var t=e.$$("cells").getSelectArea();if(t){var n=e.isCellLocked(t.start.row,t.start.column);e.lockCell(t.start,t.end,!n)}}function d(e,t,n,o){var i=n.locked,r=i.length;if(t)for(;r--;){var a=i[r],s=a[0],l=a[1];(s&&"row"==e&&s>=o.row||l&&"column"==e&&l>=o.column)&&(i[r][0]="row"==e?1*s+t:s,i[r][1]="column"==e?1*l+t:l)}}t.__esModule=!0,t.lockCss=void 0;var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};t.init=o,t.lockCell=r,t.isCellLocked=s,t.serialize=l,t.load=u;var h=n(37),p=t.lockCss="webix_lock"},function(e,t){"use strict";function n(e){var t=e.charCodeAt(1)<59?1:2,n=e.substr(0,t),o=e.substr(t);return[1*o,u[n]]}function o(e,t){var i=e.split(":");if(2!=i.length&&t)return e=t.ranges.getCode(e),e?o(e,null):null;var r=n(i[0]),a=n(i[1]);return[r[0],r[1],a[0],a[1]]}function i(e,t,n,o){return c[t]+e+":"+c[o]+n}function r(e,t){if("object"===("undefined"==typeof e?"undefined":l(e)))return e;var n=o(e,t);return{start:{row:n[0],column:n[1]},end:{row:n[2],column:n[3]}}}function a(e){return v.test(e)}function s(e,t,n,r){var s=!1;if(a(e)){var l=o(e),u=l[0],c=l[1],d=l[2],f=l[3];"row"===t&&r.row<=d?(r.row<=u&&(u+=n),d+=n,s=!0):"column"===t&&r.column<=f&&(r.column<=c&&(c+=n),f+=n,s=!0),s&&(e=i(u,c,d,f))}return e}t.__esModule=!0;var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};t.adress=n,t.range=o,t.toRange=i,t.rangeObj=r,t.isRange=a,t.changeRange=s;for(var u=t.decode={},c=t.encode={},d="ABCDEFGHIJKLMNOPQRSTUVWXYZ",f=1;1e3>f;f++){var h=parseInt((f-1)/d.length),p=(h?d[h-1]:"")+d[(f-1)%d.length];u[p]=f,c[f]=p}c[0]=c[1];var v=/[A-Z]{1,2}[0-9]+\:[A-Z]{1,2}[0-9]+/},function(e,t){"use strict";function n(e){var t=e.$$("cells");webix.UIManager.addHotKey("delete",function(){e.eachSelectedCell(function(t){return e.setCellValue(t.row,t.column,"")}),e.refresh()},t),webix.UIManager.addHotKey("any",function(e,n){if(16!=(n.which||n.keyCode)){var o=e.getSelectedId(!0);o.length&&t.config.editable&&t.edit(o[0])}},t),webix.UIManager.addHotKey("ctrl-z",function(){return e.undo()},t),webix.UIManager.addHotKey("ctrl-y",function(){return e.redo()},t),webix.UIManager.addHotKey("ctrl-b",function(){return i(e,"font-weight")},t),webix.UIManager.addHotKey("command-b",function(){return i(e,"font-weight")},t),webix.UIManager.addHotKey("ctrl-i",function(){return i(e,"font-style")},t),webix.UIManager.addHotKey("command-i",function(){return i(e,"font-style")},t),webix.UIManager.addHotKey("ctrl-u",function(t,n){return o(e,n)},t),webix.UIManager.addHotKey("command-u",function(t,n){return o(e,n)},t)}function o(e,t){t.preventDefault(),t.stopPropagation(),i(e,"text-decoration")}function i(e,t){var n=e.getSelectedId(),o=e.getStyle(n.row,n.column),i=e.$$("bar").elements[t].data,r=i.onValue,a=i.offValue,s=o&&o.props[t]===r?a:r;e.callEvent("onStyleSet",[t,s])}t.__esModule=!0,t.init=n},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){return e.attachEvent("onComponentInit",function(){return r(e)}),{view:"toolbar",css:"webix_ssheet_toolbar",elements:[{view:"label",template:"Edit: ",width:60},{view:"live-editor",disabled:!0,id:"liveEditor",suggestData:l}]}}function r(e){function t(t,n){return e.getCellEditor(t,n)||e.isCellLocked(t,n)?(r.setValue(""),r.disable(),!0):!1}function n(n,i,a){t(i.row,i.column)||(r.enable(),r.config.activeCell=i,r.setValue(a?"":e.getCellValue(i.row,i.column)),r.focus(),e.$handleSelection=function(e,t,i,r){return o(n,i,r,e)})}function o(e,t,n,o){if(t==n){if(!r.expectOperator())return i(o);r.setRange(t),webix.delay(function(){return r.focus()})}else{if(!r.expectRange())return i(o);r.setRange(t+":"+n),webix.delay(function(){return r.focus()})}return!1}function i(t){return r.isEnabled()&&(r.updateCellValue(),r.setValue(t?e.getCellValue(t.row,t.column):"")),!0}var r=e.$$("liveEditor");e._table.attachEvent("onBeforeEditStart",function(e){return n(this,e,!0),!1}),e.attachEvent("onCellChange",function(e,t,n){var o=r.config.activeCell;o&&o.row==e&&o.column==t&&r.setValue(n)}),e.attachEvent("onAfterSelect",function(t){if(!e.$handleSelection){var o=t[0];n(e._table,o)}}),e.attachEvent("onAction",function(e,n){"lock"!=e&&"filter"!=e&&"dropdown"!=e||t(n.row,n.column)})}t.__esModule=!0,t.init=i;var a=n(42),s=o(a),l=Object.keys(s);l.splice(l.indexOf("__esModule"),1)},function(e,t){"use strict";function n(e){return!e&&0!==e||(e=1*e,isNaN(e))?!1:e}function o(e){for(var t=0,o=0;o<e.length;o++){var i=n(e[o]);i!==!1&&(t+=i)}return t}function i(e){return e.join("")}function r(e){for(var t=0,o=0,i=0;i<e.length;i++){var r=n(e[i]);r!==!1&&(t+=r,o++)}return t/o}function a(e){for(var t=0,o=0;o<e.length;o++){var i=n(e[o]);i!==!1&&t++}return t}function s(e){for(var t=0,n=0;n<e.length;n++)e[n]&&1*e[n]!==0&&t++;return t}function l(e){for(var t=0,n=0;n<e.length;n++)1*!e[n]&&t++;return t}function u(e){for(var t="",o=0;o<e.length;o++){var i=n(e[o]);i!==!1&&(i>t||""===t)&&(t=i)}return t||0}function c(e){for(var t="",o=0;o<e.length;o++){var i=n(e[o]);i!==!1&&(t>i||""===t)&&(t=i)}return t||0}function d(e){for(var t="",o=0;o<e.length;o++){var i=n(e[o]);i!==!1&&(t=""===t?i:t*i)}return t}function f(e){var t=e[0].length;for(var o in e)if(e[o].length!==t)return;for(var i=0,o=0;o<e[0].length;o++){var r="";for(var a in e){var s=n(e[a][o]);if(s===!1){r=0;break}r=""===r?s:r*s}webix.isUndefined(r)||(i+=r)}return i}function h(e){for(var t=0,o=0;o<e.length;o++){var i=n(e[o]);"number"==typeof i&&(t+=Math.pow(i,2))}return t}function p(e){for(var t=this.COUNT(e),o=this.AVERAGE(e),i=0,r=0;r<e.length;r++){var a=n(e[r]);a!==!1&&(i+=Math.pow(a-o,2))}return i/t}function v(e){return Math.sqrt(this.VARP(e))}function w(e,t){var o=n(e),i=n(t);return"number"==typeof o&&"number"==typeof i?Math.pow(o,i):void 0}function m(e,t){var o=n(e),i=n(t);return"number"==typeof o&&"number"==typeof i?o/i:void 0}function g(e){var t=n(e);return t!==!1&&t>=0?Math.sqrt(t):void 0}function b(e){var t=n(e);return t!==!1?Math.abs(t):void 0}function _(){return Math.random()}function x(){return Math.PI}function y(e){var t=n(e);return t!==!1?Math.round(t):void 0}function C(e,t){var o=n(e),i=n(t)||0;return o!==!1?parseFloat(o.toFixed(i)):void 0}function $(e,t){var o=n(e),i=n(t)||0;return o!==!1?Math.floor(o*Math.pow(10,i))/Math.pow(10,i):void 0}function S(e,t){var o=n(e),i=n(t)||0;return o!==!1?Math.ceil(o*Math.pow(10,i))/Math.pow(10,i):void 0}function E(e){var t=n(e);return t!==!1?parseInt(t):void 0}function V(e){var t=n(e);if(t!==!1){var o=Math.round(t);return o%2?o+1:o}}function k(e){var t=n(e);if(t!==!1){var o=Math.round(t);return o%2?o:o+1}}function M(e){return'<img src="'+e+'">'}function I(e,t,n,o){var i,r={type:t,color:n,negativeColor:o},a="pie"==t?60:150;for(i=0;i<e.length;i++)e[i]=e[i]||0;return webix.Sparklines.getTemplate(r)(e,{width:a,height:35})}function R(e,t){return t=t||e,'<a target="blank" href="'+e+'">'+t+"</a>"}function A(e,t,n){return e?t:n}t.__esModule=!0,t.SUM=o,t.CONCATENATE=i,t.AVERAGE=r,t.COUNT=a,t.COUNTA=s,t.COUNTBLANK=l,t.MAX=u,t.MIN=c,t.PRODUCT=d,t.SUMPRODUCT=f,t.SUMSQ=h,t.VARP=p,t.STDEVP=v,t.POWER=w,t.QUOTIENT=m,t.SQRT=g,t.ABS=b,t.RAND=_,t.PI=x,t.INT=y,t.ROUND=C,t.ROUNDDOWN=$,t.ROUNDUP=S,t.TRUNC=E,t.EVEN=V,t.ODD=k,t.IMAGE=M,t.SPARKLINE=I,t.LINK=R,t.IF=A},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){e.attachEvent("onComponentInit",function(){return s(e)});var t={view:"toolbar",id:"bottom-toolbar",css:"webix_ssheet_bottom_toolbar webix_layout_toolbar",paddingY:0,height:34,elements:[{view:"button",type:"htmlbutton",width:34,id:"add-sheet",label:"<span class='webix_ssheet_icon_add_sheet'></span>",tooltip:webix.i18n.spreadsheet.tooltips["add-sheet"]||""},{id:"sheets",view:"sheets",xCount:5,editable:!0,editaction:"dblclick",editor:"text",editValue:"value",type:{width:e.config.sheetTabWidth,height:32,template:"<div>#value#</div> <div class='webix_input_icon fa-angle-down webix_ssheet_sheet_arrow'></div>"},on:{onItemClick:function(t){t!=e._activeSheet&&e.showSheet(t)}}},{id:"menu-pager",view:"pager",autosize:!0,template:function(){var e="<button type='button' webix_p_id='prev' class='webix_pager_item'><span class='webix_icon fa-caret-left'></span></button>";return e+="<button type='button' webix_p_id='next' class='webix_pager_item'><span class='webix_icon fa-caret-right'></span></button>"}}]};return e.callEvent("onViewInit",["bottom-toolbar",t]),t}function r(e){for(var t=[],n=0;n<$.length;n++)t.push({id:$[n],value:webix.i18n.spreadsheet.menus[$[n]]||$[n]});var o={view:"ssheet-suggest",data:t};return e.callEvent("onViewInit",["sheet-menu",o]),o}function a(e,t){var n=e.$$("sheets");n&&!function(){var e=[];t.sheets.forEach(function(t){e.push({id:t.name,value:t.name})}),n.parse(e)}()}function s(e){e.$$("add-sheet")&&e.$$("add-sheet").attachEvent("onItemClick",function(){u(e)}),l(e),e.attachEvent("onSheetShow",function(t){return f(e,t)}),e.attachEvent("onCommand",function(e){S[e.id]&&S[e.id](this)}),e.$$("sheets")&&(e.$$("sheets").data.attachEvent("onStoreUpdated",function(){return h(e)}),e.$$("sheets").attachEvent("onAfterEditStop",function(t){return w(e,t.old,t.value)}),e.$$("sheets").on_click.webix_ssheet_sheet_arrow=function(t,n){e.$sheetMenu||(e.$sheetMenu=webix.ui(r(e)),e.$sheetMenu.attachEvent("onItemClick",function(t){return x(e,t)})),e.$sheetMenu.getItem("remove-sheet")&&(1==e.$$("sheets").count()?e.$sheetMenu.disableItem("remove-sheet"):e.$sheetMenu.enableItem("remove-sheet")),e.callEvent("onBeforeSheetMenu",[n])&&e.$sheetMenu.show(t)})}function l(e){e.$$("menu-pager")&&(e.$$("sheets").define("pager",e.$$("menu-pager")),e.$$("menu-pager").attachEvent("onAfterRender",function(){this.data.page?webix.html.removeCss(this.$view.firstChild,"ssheet_pager_inactive",!0):webix.html.addCss(this.$view.firstChild,"ssheet_pager_inactive",!0),this.data.page==this.config.limit-1?webix.html.addCss(this.$view.lastChild,"ssheet_pager_inactive",!0):webix.html.removeCss(this.$view.lastChild,"ssheet_pager_inactive",!0)}))}function u(e,t){var n,o,i;return n=C.findIndex(e._sheets,function(t){return t.name==e._activeSheet}),i=n>-1?n+1:e._sheets.length,o=d(e),t=t||{data:[]},e._sheets.splice(i,0,{name:o,content:t}),e.$$("sheets").add({id:o,value:o},i),e.showSheet(o),o}function c(e){e.reset()}function d(e){for(var t=e._sheets.length+1;C.find(e._sheets,function(e){return e.name==webix.i18n.spreadsheet.labels.sheet+t});)t++;var n=webix.i18n.spreadsheet.labels.sheet+t;return n}function f(e,t){if(e.$$("sheets").select(t),e.$$("menu-pager")&&e.$$("sheets").config.xCount){var n=e.$$("sheets").getIndexById(t),o=Math.floor(n/e.$$("sheets").config.xCount);e.$$("menu-pager").select(o)}}function h(e){e.$$("menu-pager")&&(e.$$("sheets").count()<=e.$$("sheets").config.xCount?webix.html.addCss(e.$$("menu-pager").$view,"webix_sheet_hidden",!0):webix.html.removeCss(e.$$("menu-pager").$view,"webix_sheet_hidden"))}function p(e,t){e.$$("sheets").edit(t)}function v(e,t){var n,o;e._sheets.length>1&&(n=C.findIndex(e._sheets,function(e){return e.name==t}),e._sheets.splice(n,1),e._sheets[n]||(n=0),o=e._sheets[n],e._activeSheet=null,e.$$("sheets")&&(e.$$("sheets").remove(t),e.$$("sheets").refresh()),e.showSheet(o.name))}function w(e,t,n){var o=C.find(e._sheets,function(e){return e.name==t});if(o&&t!=n&&(o.name=n,e._activeSheet==t&&(e._activeSheet=n),e.$$("sheets"))){var i=e.$$("sheets").getItem(t);i.value=n,e.$$("sheets").data.changeId(t,n),e.$$("sheets").refresh(n)}}function m(e,t){return C.find(e._sheets,function(t){return t.name==e._activeSheet}).content=t,e._sheets}function g(e,t){var n="";t.excel?(n=e._activeSheet,C.find(e._sheets,function(e){return e.name==n}).content=t):(n=webix.i18n.spreadsheet.labels.sheet,e._activeSheet="",t.sheets?n=t.sheets[0].name:(n+=1,t={sheets:[{name:n,content:t}]}),e._sheets=t.sheets,a(e,t)),e.showSheet(n)}function b(e,t){e._activeSheet&&t!=e._activeSheet&&(C.find(e._sheets,function(t){return t.name==e._activeSheet}).content=e.serialize()),e.callEvent("onReset",[]),e._activeSheet=t;var n=C.find(e._sheets,function(e){return e.name==t}).content,o=Math.max(e.config.rowCount,n.data.length),i=n.data[0]?Math.max(e.config.columnCount,n.data[0].length):e.config.columnCount;o==e.config.rowCount&&i==e.config.columnCount||(e.config.rowCount=o,e.config.columnCount=i,e._resetTable()),e.callEvent("onDataParse",[n]),e.callEvent("onSheetShow",[t]),e._table.refresh()}function _(e){u(e,e.serialize())}function x(e,t){e.$sheetMenu.data.getMark(t,"webix_disabled")||S[t](e)}t.__esModule=!0,t.init=i,t.reset=a,t.add=u,t.clear=c,t.edit=p,t.remove=v,t.rename=w,t.serialize=m,t.load=g,t.show=b;var y=n(44),C=o(y),$=["rename-sheet","remove-sheet"],S={"remove-sheet":function(e){e.confirm({text:webix.i18n.spreadsheet.labels["sheet-remove-confirm"],callback:function(t){t&&v(e,e._activeSheet)}})},"rename-sheet":function(e){p(e,e._activeSheet)},"new-sheet":function(e){u(e)},"copy-sheet":function(e){_(e)}}},function(e,t){"use strict";function n(e,t){var n=o(e,t);return e[n]}function o(e,t){for(var n=-1,o=0;0>n&&o<e.length;o++)t(e[o])&&(n=o);return n}t.__esModule=!0,t.find=n,t.findIndex=o},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){for(var t=0;t<x.length;t++)y[x[t].action]=new x[t].DialogBox(e);e.attachEvent("onCommand",function(e){var t=y[e.id];t&&t.open()})}t.__esModule=!0,t.init=i;var r=n(46),a=o(r),s=n(48),l=o(s),u=n(50),c=o(u),d=n(51),f=o(d),h=n(52),p=o(h),v=n(53),w=o(v),m=n(54),g=o(m),b=n(55),_=o(b),x=[a,l,c,f,p,w,g,_],y={}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){var t=this;if(!this.config.upload){var n=new FileReader;return n.onload=function(e){return t.getFormView().elements.url.setValue(e.target.result)},n.readAsDataURL(e.file),!1}this.getFormView().elements.preview.setHTML("")}function s(e,t){this.getFormView().elements.url.setValue(t.imageURL)}function l(e){var t=e.view.getSelectedId(),n=e.$dialog.getBody().elements.url.getValue();/^https?:\/\//i.test(n)||(n="http://"+n),e.view.addImage(t.row,t.column,n),e.close()}function u(e){e&&this.getFormView().elements.preview.setHTML("<img style='max-width:100%; max-height:100%;' src='"+e+"'></img>")}t.__esModule=!0,t.DialogBox=t.action=void 0;var c=n(47);t.action="add-image",t.DialogBox=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return r(t,e),t.prototype.$show=function(e,t){var n=this.view.getSelectedId();return n?(t.elements.preview.setHTML(""),t.elements.url.setValue(""),void t.elements.url.focus()):!1},t.prototype.$init=function(){var e=this,t=this.view.config.save,n=t&&t.images||null;return{view:"ssheet-dialog",head:webix.i18n.spreadsheet.labels["image-title"],move:!0,position:"center",body:{view:"form",elements:[{view:"text",name:"url",placeholder:webix.i18n.spreadsheet.labels["image-url"],on:{onChange:u}},{view:"label",label:webix.i18n.spreadsheet.labels["image-or"],align:"center"},{view:"uploader",label:webix.i18n.spreadsheet.labels["image-upload"],
upload:n,on:{onBeforeFileAdd:a,onFileUpload:s}},{view:"formlate",name:"preview",borderless:!0,css:"webix_ssheet_preview",template:"",height:50}]},on:{onSaveClick:function(){return l(e)},onHideClick:function(){return e.close()},onCancelClick:function(){return e.close()}}}},t}(c.Dialog)},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0,t.Dialog=void 0,n(18);t.Dialog=function(){function e(t){o(this,e),this.view=t}return e.prototype.$init=function(){},e.prototype.$show=function(){},e.prototype.$hide=function(){},e.prototype.open=function(){var e=this;this.$dialog||(this.$dialog=webix.ui(this.$init()),this.$dialog.attachEvent("onHide",function(){return e.$hide()}));var t=this.$dialog.getBody();this.$dialog.show(),this.$show(this.$dialog,t)===!1&&this.close()},e.prototype.close=function(){this.$dialog.hide()},e}()},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){var t=e.$dialog.getBody(),n=t.getValues();if(n.range)if((0,f.range)(n.range,e.view)){var o=void 0,i=(0,d.rangeValue)(e.view,n.range),r=s(t);for(o=0;o<i.length;o++)i[o]=i[o]||0;t.elements.preview.setValue(webix.Sparklines.getTemplate(r)(i,{width:200,height:40}))}else e.view.alert({text:webix.i18n.spreadsheet.labels["error-range"]})}function s(e,t){var n=e.getValues();return t=t||{type:n.type},"bar"===n.type?(t.color=n.color_pos,t.negatibeColor=n.color_neg):e.elements.color_def.isVisible()&&(t.color=n.color_def),t}function l(e){var t=e.$dialog.getBody(),n=s(t,t.getValues());e.view.addSparkline(e.cell.row,e.cell.column,n),e.close()}function u(e){var t=this.getFormView();switch(e){case"pie":t.showBatch(3);break;case"bar":t.showBatch(2);break;default:t.showBatch(1)}}t.__esModule=!0,t.DialogBox=t.action=void 0;var c=n(47),d=n(49),f=n(39),h=(t.action="add-sparkline",[{id:"line",value:"Line"},{id:"spline",value:"Spline"},{id:"splineArea",value:"Spline Area"},{id:"area",value:"Area"},{id:"bar",value:"Bar"},{id:"pie",value:"Pie"}]);t.DialogBox=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return r(t,e),t.prototype.$show=function(e,t){return this.cell=this.view.getSelectedId(),this.cell?(this.view.$handleSelection=function(e,n,o,i){return t.elements.range.setValue(o+":"+i),!1},t.elements.range.setValue(""),void t.elements.range.focus()):!1},t.prototype.$hide=function(){this.view.$handleSelection=null},t.prototype.$init=function(){var e=this;return{view:"ssheet-dialog",head:webix.i18n.spreadsheet.labels["sparkline-title"],move:!0,position:"center",body:{view:"form",id:"form",visibleBatch:1,on:{onChange:function(){return a(e)}},elements:[{view:"richselect",name:"type",label:webix.i18n.spreadsheet.labels["sparkline-type"],value:"line",labelPosition:"left",suggest:{view:"ssheet-form-suggest",data:h},on:{onChange:u}},{view:"text",label:webix.i18n.spreadsheet.labels["sparkline-range"],name:"range"},{view:"ssheet-colorpicker",label:webix.i18n.spreadsheet.labels["sparkline-color"],name:"color_def",id:"add_sparkline_color",value:"#6666FF",batch:"1"},{view:"ssheet-colorpicker",label:webix.i18n.spreadsheet.labels["sparkline-positive"],name:"color_pos",value:"#6666FF",batch:"2"},{view:"ssheet-colorpicker",label:webix.i18n.spreadsheet.labels["sparkline-negative"],name:"color_neg",value:"#FF6666",batch:"2"},{view:"formlate",name:"preview",borderless:!0,css:"webix_ssheet_preview",height:50}]},on:{onSaveClick:function(){return l(e)},onHideClick:function(){return e.close()},onCancelClick:function(){return e.close()}}}},t}(c.Dialog)},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,n){var o=r(e,(0,a.range)(t,e));if(n){if(n.unique)for(var i={},s=o.length-1;s>=0;s--)i[o[s]]?o.splice(s,1):i[o[s]]=!0;n.order&&o.sort(),n.empty&&o.unshift({id:"$empty",$empty:!0,value:""})}return o}function r(e,t){for(var n=t[0],o=t[1],i=t[2],r=t[3],a=[],s=n;i>=s;s++)for(var l=e.getRow(s),u=o;r>=u;u++)a.push(l[u]);return a}t.__esModule=!0,t.Ranges=void 0,t.rangeValue=i,t.getData=r;var a=n(39);t.Ranges=function(){function e(t){o(this,e),this._master=t,this._ranges={}}return e.prototype.clear=function(){this._ranges={}},e.prototype.add=function(e,t){var n=!!this._ranges[e];this._ranges[e]=t,n&&this._master.callEvent("onMathRefresh",[])},e.prototype.getCode=function(e){return this._ranges[e]},e.prototype.remove=function(e){delete this._ranges[e]},e.prototype.getData=function(e){return i(this._master,this._ranges[e])},e.prototype.getRanges=function(){var e=[];for(var t in this._ranges)e.push({name:t,range:this._ranges[t]});return e},e.prototype.parse=function(e){if(e)for(var t=e.length;t--;){var n=e[t];this._ranges[n[0]]=n[1]}},e.prototype.serialize=function(){var e,t=[];for(e in this._ranges)t.push([e,this._ranges[e]]);return t},e}()},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0,t.DialogBox=t.action=void 0;var a=n(47),s=n(39);t.action="add-range",t.DialogBox=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return r(t,e),t.prototype.$show=function(e){var t=e.$$("table"),n=e.$$("form");n.clear(),n.elements.name.focus(),n.elements.range.setValue(this.view.getSelectedRange()),t.clearAll(),t.parse(this.view.ranges.getRanges()),this.view.$handleSelection=function(e,t,o,i){return n.elements.range.setValue(o+":"+i),!1}},t.prototype.$hide=function(){this.view.$handleSelection=null},t.prototype.saveClick=function(){var e=this.$dialog.$$("form"),t=e.getValues();t.range=t.range.toUpperCase(),t.name=t.name.toUpperCase(),e.setValues(t),e.validate()&&(t.id&&this.$dialog.$$("table").exists(t.id)?this.$dialog.$$("table").updateItem(t.id,t):this.$dialog.$$("table").add(t),this.view.ranges.add(t.name,t.range),e.clear())},t.prototype.removeRange=function(e){var t=this;this.view.confirm({text:webix.i18n.spreadsheet.labels["range-remove-confirm"],callback:function(n){if(n){var o=t.$dialog.$$("table");t.view.ranges.remove(o.getItem(e).name),o.remove(e)}}})},t.prototype.editRange=function(e){var t=this.$dialog.$$("form");t.setValues(this.$dialog.$$("table").getItem(e))},t.prototype.$init=function(){var e=this,t={type:"clean",cols:[{view:"ssheet-dialog-table",id:"table",borderless:!0,columns:[{id:"name",header:webix.i18n.spreadsheet.labels["range-name"],width:120},{id:"range",header:webix.i18n.spreadsheet.labels["range-cells"],width:100},{template:"<div class='webix_icon webix_ssheet_range_edit'></div>",width:30},{template:"<div class='webix_icon webix_ssheet_range_delete'></div>",width:30}],autowidth:!0,height:150,onClick:{webix_ssheet_range_delete:function(t,n){return e.removeRange(n)},webix_ssheet_range_edit:function(t,n){return e.editRange(n)}}},{width:250,view:"form",id:"form",rules:{name:function(e){return/^[A-Za-z]+$/.test(e)},range:s.isRange},elementsConfig:{labelWidth:100},elements:[{view:"text",name:"name",gravity:1,label:webix.i18n.spreadsheet.labels["range-name"]},{view:"text",name:"range",gravity:1,label:webix.i18n.spreadsheet.labels["range-cells"]},{cols:[{},{view:"button",value:"Save",click:function(){return e.saveClick()}}]}]}]};return{view:"ssheet-dialog",move:!0,head:webix.i18n.spreadsheet.labels["range-title"],buttons:!1,autoheight:!0,width:570,position:"center",body:t,on:{onSaveClick:function(){return e.close()},onHideClick:function(){return e.close()},onCancelClick:function(){return e.close()}}}},t}(a.Dialog)},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0,t.DialogBox=t.action=void 0;var a=n(47),s=n(39),l=n(37);t.action="add-dropdown",t.DialogBox=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return r(t,e),t.prototype.$show=function(){var e=this.$dialog.$$("form");return this.cell=this.view.getSelectedId(!0),this.cell.length?(this.view.$handleSelection=function(t,n,o,i){return e.elements.range.setValue(o+":"+i),!1},e.clear(),void e.elements.range.focus()):!1},t.prototype.$hide=function(){this.view.$handleSelection=null},t.prototype.$init=function(){var e=this;return{view:"ssheet-dialog",position:"center",head:webix.i18n.spreadsheet.labels["dropdown-title"],move:!0,body:{view:"form",id:"form",rows:[{view:"text",label:webix.i18n.spreadsheet.labels["dropdown-range"],name:"range"}]},on:{onSaveClick:function(){return e.okClick()},onHideClick:function(){return e.close()},onCancelClick:function(){return e.close()}}}},t.prototype.okClick=function(){var e=this.$dialog.$$("form").elements.range.getValue();e?(0,s.range)(e,this.view)?(l.group.set(function(){for(var t=0;t<this.cell.length;t++)this.view.setCellEditor(this.cell[t].row,this.cell[t].column,{editor:"richselect",options:e})},this),this.close()):this.view.alert({text:webix.i18n.spreadsheet.labels["error-range"]}):this.close()},t}(a.Dialog)},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0,t.DialogBox=t.action=void 0;var s=n(47),l=n(32),u=o(l);t.action="custom-format",t.DialogBox=function(e){function t(){return i(this,t),r(this,e.apply(this,arguments))}return a(t,e),t.prototype.$show=function(){var e=this.$dialog.$$("form");if(this.cell=this.view.getSelectedId(!0),!this.cell)return!1;if(e.clear(),e.elements.format.focus(),this.cell.length>0){var t=this.view.getStyle(this.cell[0].row,this.cell[0].column);t&&e.elements.format.setValue(u.getFormatSource(t.props.format))}},t.prototype.$init=function(){var e=this;return{view:"ssheet-dialog",position:"center",head:webix.i18n.spreadsheet.labels["format-title"],move:!0,body:{view:"form",id:"form",rows:[{view:"text",label:webix.i18n.spreadsheet.labels["format-pattern"],name:"format",labelPosition:"top",placeholder:"[>100]0,000.00;[>0]None"}]},on:{onSaveClick:function(){return e.okClick()},onHideClick:function(){return e.close()},onCancelClick:function(){return e.close()}}}},t.prototype.okClick=function(){for(var e=this.$dialog.$$("form").elements.format.getValue(),t=0;t<this.cell.length;t++)this.view.setFormat(this.cell[t].row,this.cell[t].column,e);this.view.refresh(),this.close()},t}(s.Dialog)},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return e.map(function(e){return e.id=e.css,e})}t.__esModule=!0,t.DialogBox=t.action=void 0;var s=n(47),l=(t.action="conditional-format",[{id:">",value:">"},{id:"<",value:"<"},{id:"=",value:"="},{id:"<>",value:"<>"}]);t.DialogBox=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return r(t,e),t.prototype._getCondition=function(){var e=this.view,t=this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews(),n=[];t.forEach(function(e){if(e.getValues){var t=e.getValues(),o=[];o.push(t.condition),"<>"!==t.condition?o.push(parseInt(t.value,10)):o.push([parseInt(t.value,10),parseInt(t.value2,10)]),o.push(t.style);for(var i=0;i<o.length;i++)if(""===o[i])return!1;n.push(o)}}),e.callEvent("onConditionSet",[n])},t.prototype._setCondition=function(){var e=this,t=this.view,n=t.getSelectedId(!0),o=n[0];if(1!==n.length)return!1;var i=t.conditions.get(o.row,o.column);i&&!function(){var t=e.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();i.forEach(function(e,n){var o={};o.condition=e[0],webix.isArray(e[1])?(o.value=e[1][0].toString(),o.value2=e[1][1].toString()):o.value=e[1].toString(),o.style=e[2],t[n+1].setValues(o)})}()},t.prototype.apply=function(){this._getCondition(),this.close()},t.prototype._clean=function(){var e=this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();e.forEach(function(e){e.setValues&&e.setValues({condition:"",value:"",value2:"",style:""})})},t.prototype.$show=function(){this._setCondition()},t.prototype.$hide=function(){this._clean()},t.prototype.getRows=function(e,t){for(var n={height:36,cols:[{view:"label",label:webix.i18n.spreadsheet.labels.display},{view:"label",label:webix.i18n.spreadsheet.labels.condition},{view:"label",label:webix.i18n.spreadsheet.labels.value}]},o=[n],i={view:"form",padding:0,borderless:!0,elements:[{margin:10,cols:[{view:"richselect",name:"style",placeholder:webix.i18n.spreadsheet.labels["conditional-style"],css:"webix_ssheet_cformat_select",suggest:{padding:0,borderless:!0,css:"webix_ssheet_cformat_list",body:{template:function(e){var t="webix_ssheet_cformat "+e.css;return'<div class="'+t+'">'+e.name+"</div>"},data:e}}},{view:"richselect",width:100,name:"condition",placeholder:webix.i18n.spreadsheet.labels["conditional-operator"],on:{onChange:function(e){"<>"===e?this.getFormView().elements.value2.show():this.getFormView().elements.value2.hide()}},suggest:{view:"ssheet-form-suggest",body:{data:l}}},{cols:[{view:"text",placeholder:webix.i18n.spreadsheet.labels["conditional-number"],name:"value"},{view:"text",name:"value2",hidden:!0}]}]}]};t--;)o.push(i);return o},t.prototype.$init=function(){var e=this;return{view:"ssheet-dialog",head:webix.i18n.spreadsheet.labels["conditional-format"],position:"center",width:450,move:!0,buttons:!1,body:{view:"form",borderless:!0,rows:[{rows:this.getRows(a(this.view.config.conditionStyle),3)},{cols:[{gravity:2},{view:"button",value:webix.i18n.spreadsheet.labels.apply,click:function(){return e.apply()}}]}]},on:{onHideClick:function(){return e.close()}}}},t}(s.Dialog)},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){var t=e.$dialog.getBody().elements.name.getValue();webix.toExcel(e.view,{name:t}),e.close()}t.__esModule=!0,t.DialogBox=t.action=void 0;var s=n(47);t.action="excel-export",t.DialogBox=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return r(t,e),t.prototype.$show=function(e,t){t.elements.name.setValue("Data"),t.elements.name.getInputNode().select()},t.prototype.$init=function(){var e=this;return{view:"ssheet-dialog",head:webix.i18n.spreadsheet.labels["export-title"],move:!0,position:"center",body:{view:"form",elements:[{view:"text",name:"name",placeholder:webix.i18n.spreadsheet.labels["export-name"]}]},on:{onSaveClick:function(){return a(e)},onHideClick:function(){return e.close()},onCancelClick:function(){return e.close()}}}},t}(s.Dialog)},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){var t=e.view.getSelectedId(),n=e.$dialog.getBody().getValues(),o="";n.url&&(n.name=n.name||n.url,/^https?:\/\//i.test(n.url)||(n.url="http://"+n.url),o='=LINK("'+n.url+'","'+n.name+'")'),e.view.setCellValue(t.row,t.column,o),e.view.refresh(),e.close()}t.__esModule=!0,t.DialogBox=t.action=void 0;var s=n(47);t.action="add-link",t.DialogBox=function(e){function t(){return o(this,t),i(this,e.apply(this,arguments))}return r(t,e),t.prototype.$show=function(e,t){var n=this.view.getSelectedId();return n?(this.restoreValue(t)||t.clear(),void t.elements.name.focus()):!1},t.prototype.restoreValue=function(e){var t=this.view.getSelectedId();if(t){var n=this.view.getRow(t.row),o=n["$"+t.column]||n[t.column];if(o&&0===o.indexOf("=LINK")){var i=o.split('"');return e.setValues({name:i[3]||"",url:i[1]||""}),!0}}return!1},t.prototype.$init=function(){var e=this;return{view:"ssheet-dialog",head:webix.i18n.spreadsheet.labels["link-title"],move:!0,position:"center",body:{view:"form",elements:[{view:"text",name:"name",placeholder:webix.i18n.spreadsheet.labels["link-name"]},{view:"text",name:"url",placeholder:webix.i18n.spreadsheet.labels["link-url"]}]},on:{onSaveClick:function(){return a(e)},onHideClick:function(){return e.close()},onCancelClick:function(){return e.close()}}}},t}(s.Dialog)},function(e,t,n){"use strict";function o(e){e.attachEvent("onComponentInit",function(){return e.$$("context").attachTo(e._table.$view)});var t=webix.i18n.spreadsheet.menus,n={data:[{id:"clear-styles",value:t["clear-styles"]},{id:"lock-cell",value:t["lock-cell"]},{$template:"Separator"},{id:"sort",value:t.sort,submenu:[{id:"sort-asc",value:t["sort-asc"]},{id:"sort-desc",value:t["sort-desc"]}]},{id:"create-filter",value:t["create-filter"]},{$template:"Separator"},{id:"add-range",value:t["add-range"]},{id:"add-link",value:t["add-link"]}],column:[{id:"add",group:"column",value:t["insert-column"]},{id:"del",group:"column",value:t["delete-column"]},{id:"show",group:"column",value:t["show-column"]},{id:"hide",group:"column",value:t["hide-column"]}],row:[{id:"add",group:"row",value:t["insert-row"]},{id:"del",group:"row",value:t["delete-row"]},{id:"show",group:"row",value:t["show-row"]},{id:"hide",group:"row",value:t["hide-row"]}]},o={view:"contextmenu",id:"context",padding:0,submenuConfig:{padding:0},data:[],on:{onMenuItemClick:function(t){e.callEvent("onCommand",[this.getMenuItem(t)])},onBeforeShow:function(t){var o,a,s=!1;if(a=e._table.locate(t),!a)return!1;if(o="",a.header&&"rowId"!==a.column)(0,r.selectColumn)(a.column,e),o="column";else if(a.row)if("rowId"===a.column)(0,r.selectRow)(a.row,e),o="row";else{for(var l=e.getSelectedId(!0),u=0;!s&&u<l.length;u++)l[u].row==a.row&&l[u].column==a.column&&(s=!0);s||e._table.addSelectArea(a,a),o="data"}if(o){var c=i(e,o,n[o]);if(c)return this.clearAll(),this.parse(c),webix.html.preventEvent(t),!0}return!1}}};e.callEvent("onViewInit",["context",o]),e.ui(o)}function i(e,t,n){var o={area:t,data:n};return e.callEvent("onContextMenuConfig",[o])?o&&o.data:null}t.__esModule=!0,t.init=o,t.getMenuData=i;var r=n(35)},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){for(var t=[a,f,E,B,l,_,k,I,T,c,y,$,A,p,w,g,z,D,F],n=0;n<t.length;n++)t[n].init&&t[n].init(e)}t.__esModule=!0,t.operations=i;var r=n(58),a=o(r),s=n(62),l=o(s),u=n(35),c=o(u),d=n(63),f=o(d),h=n(64),p=o(h),v=n(66),w=o(v),m=n(67),g=o(m),b=n(32),_=o(b),x=n(68),y=o(x),C=n(38),$=o(C),S=n(69),E=o(S),V=n(70),k=o(V),M=n(71),I=o(M),R=n(73),A=o(R),O=n(74),z=o(O),U=n(36),B=o(U),P=n(37),T=o(P),N=n(78),D=o(N),j=n(77),F=o(j)},function(e,t,n){(function(e){"use strict";function o(t){t.attachEvent("onCommand",function(n){if("add"==n.id||"del"==n.id){var o=t._table.getSelectArea();o&&d.group.set(function(){e(n,o.start,o.end,t)})}}),t.attachEvent("onUndo",function(e,n,o,r){"grid-change"==e&&i(t,r)})}function e(e,t,n,o,f,h){var p,v,w,m,g,b=0,_=0;w=o.serialize({math:!0}),m=webix.copy(w),g=r(e,t,n),f||(0,d.ignoreUndo)(function(){o.callEvent("onAction",["before-grid-change",{name:g.name,inc:g.inc,data:w,start:t}])},o),p=w.data,"column"==e.group?(b=n.column-t.column+1,_=t.column,"add"==e.id?a(e,t,n,o,f,h,p):"del"==e.id&&(s(e,t,n,o,f,h,p),b=-b)):"row"==e.group&&(b=n.row-t.row+1,_=t.row,"add"==e.id?l(e,t,n,o,f,h,p):"del"==e.id&&(u(e,t,n,o,f,h,p),b=-b));var x={id:e.group,start:_,count:b};for(v=p.length;v--;)p[v][2]&&"string"==typeof p[v][2]&&"="==p[v][2].substr(0,1)&&(p[v][2]=(0,c.updateMath)(p[v][2],x));o.callEvent("onAction",["grid-change",{value:m,newValue:w}]),(0,d.ignoreUndo)(function(){i(o,w)},o)}function i(e,t){(0,d.ignoreReset)(function(){e.parse(t)})}function r(e,t,n){var o=e.group,i="add"==e.id?1:"del"==e.id?-1:0;return i&&("row"==o&&(i+=i*(n.row-t.row)),"column"==o&&(i+=i*(n.column-t.column))),{name:o,inc:i}}function a(e,t,n,o,i,r,a){var s=a.length,l=n.column-t.column+1;for(o.config.columnCount+=l,o.reset({select:!0});s--;)a[s][1]>=t.column&&(a[s][1]+=l);i?a.push.apply(a,r):o.callEvent("onColumnChange",[e,t,n,null])}function s(e,t,n,o,i,r,a){var s=a.length,l=n.column-t.column+1;o.config.columnCount-=l,o.reset({select:!0});for(var u=[];s--;)a[s][1]>=t.column&&a[s][1]<=n.column?u.push(a.splice(s,1)[0]):a[s][1]>n.column&&(a[s][1]-=l);i||o.callEvent("onColumnChange",[e,t,n,u])}function l(e,t,n,o,i,r,a){var s=a.length,l=n.row-t.row+1;for(o.config.rowCount+=l,o.reset({select:!0});s--;)a[s][0]>=t.row&&(a[s][0]+=l);i?a.push.apply(a,r):o.callEvent("onRowChange",[e,t,n,null])}function u(e,t,n,o,i,r,a){var s=a.length,l=n.row-t.row+1;o.config.rowCount-=l,o.reset({select:!0});for(var u=[];s--;)a[s][0]>=t.row&&a[s][0]<=n.row?u.push(a.splice(s,1)[0]):a[s][0]>n.row&&(a[s][0]-=l);i||o.callEvent("onRowChange",[e,t,n,u])}t.__esModule=!0,t.init=o,t.process=e;var c=n(60),d=n(37)}).call(t,n(59))},function(e,t){function n(){u=!1,a.length?l=a.concat(l):c=-1,l.length&&o()}function o(){if(!u){var e=setTimeout(n);u=!0;for(var t=l.length;t;){for(a=l,l=[];++c<t;)a&&a[c].run();c=-1,t=l.length}a=null,u=!1,clearTimeout(e)}}function i(e,t){this.fun=e,this.array=t}function r(){}var a,s=e.exports={},l=[],u=!1,c=-1;s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new i(e,t)),1!==l.length||u||setTimeout(o,0)},i.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=r,s.addListener=r,s.once=r,s.off=r,s.removeListener=r,s.removeAllListeners=r,s.emit=r,s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t){for(var n=(0,s.split)(e),o=n.length,i=1;o>i;i+=2){var r=n[i],l=r[0],u=r[1];"move"===t.id?(u+=t.column,l+=t.row):"row"===t.id&&t.start<=l?l+=t.count:"column"===t.id&&t.start<=u&&(u+=t.count),u&&l?n[i]=a.encode[u]+l:n[i]=0}return n.join("")}t.__esModule=!0,t.updateMath=i;var r=n(39),a=o(r),s=n(61)},function(e,t){"use strict";function n(e){var t=e.charCodeAt(0);return t>=65&&122>=t}function o(e){var t=e.charCodeAt(0);return t>=48&&57>=t}function i(e,t){for(var i=e.length,r=t+1;i>r;r++){var a=e[r];if(!n(a)&&!o(a))return e.substr(t,r-t)}return e.substr(t)}function r(e){return p.test(e)}function a(e){var t,n=o(e[1])?1:2,i=e.substr(0,n),r=e.substr(n);return t=2==i.length?28*(i.charCodeAt(0)-64)+i.charCodeAt(1)-64:i.charCodeAt(0)-64,[1*r,t]}function s(e,t){var n=a(t),o=n[0],i=n[1];return e.push([o,i,o,i]),"this.v("+o+","+i+")"}function l(e){return"this.m."+e}function u(e,t,n){var o=t.ranges.getCode(n);if(!o)return"";var i=o.split(":"),r=i[0],a=i[1];return d(e,r,a)}function c(e){return"this.p."+e}function d(e,t,n){var o=a(t),i=o[0],r=o[1],s=a(n),l=s[0],u=s[1];if(i>l){var c=i;i=l,l=c}if(r>u){var c=r;r=u,u=c}return e.push([i,r,l,u]),"this.r("+i+","+r+","+l+","+u+")"}function f(e){for(var t=[],o=0,s=!1,l=!1,u=1;u<e.length;u++){var c=e[u];if('"'==c)s=!s;else if(!s)if("{"==c&&"{"==e[u+1])l=!0;else if("}"==c&&"}"==e[u+1])l=!1;else if(!l&&n(c)){var d=i(e,u).toUpperCase(),f=u+d.length-1;"("!==e[f+1]&&r(d)&&(0!==u&&t.push(e.substr(o,u-o)),t.push(a(d)),o=f+1),u=f}}return o!=e.length&&t.push(e.substr(o)),t}function h(e,t){var o="return ",a=[],f=!1,h="";if("="!==e[0])return!1;for(var p=1;p<e.length;p++){var v=e[p];if('"'==v)f=!f;else{if("{"==v&&"{"==e[p+1]){var w=i(e,p+2);p+=w.length+3,o+=c(w);continue}if(!f&&n(v)){var w=i(e,p).toUpperCase();p+=w.length-1,"("===e[p+1]?o+=l(w):r(w)?":"===e[p+1]?(h=w,p++):""!==h?(o+=d(a,h,w),h=""):o+=s(a,w):o+=u(a,t,w);continue}}o+=e[p]}return{code:o+";",triggers:a}}t.__esModule=!0,t.position=a,t.split=f,t.parse=h;var p=/[A-Z]{1,2}[0-9]+/},function(e,t,n){"use strict";function o(e,t){var n=67,o=88,r=e.$$("cells");r.attachEvent("onKeyPress",function(t,i){t!==n&&t!==o||!i.ctrlKey&&!i.metaKey||!r.getSelectedId()||(l=a(e,r),u=document.getElementsByClassName("webix_clipbuffer")[0].value,c=r.getSelectArea(),d=t===o)}),t||r.attachEvent("onPaste",function(t){i(e,r,t)})}function i(e,t,n){var o=t.getSelectArea();if(o){var i=o.start,a=n===u,s=a?l:webix.csv.parse(n,t.config.delimiter),h={id:"move",column:0,row:0};if(a?(h.column=i.column-c.start.column,h.row=i.row-c.start.row):d=!1,f.group.start(),1==s.length&&1==s[0].length?e.eachSelectedCell(function(t){var n={id:"move",column:h.column+1*t.column-i.column,row:h.row+1*t.row-i.row};r(e,t.row,t.column,s[0][0],a,n)}):t.mapCells(i.row,i.column,s.length,null,function(t,n,o,i,l){if(s[i]&&s[i].length>l){var u=s[i][l];r(e,n,o,u,a,h)}},!0),d){for(var p=c.start.row;p<=c.end.row;p++)for(var v=c.start.column;v<=c.end.column;v++)e.setCellValue(p,v,null),e.setStyle(p,v,null);d=!1}f.group.end(),e.refresh()}}function r(e,t,n,o,i,r){var a=o,l=null;"object"===("undefined"==typeof o?"undefined":s(o))&&(a=o.math?(0,h.updateMath)(o.math,r):o.text,l=o.style),e.setCellValue(t,n,a),i&&e.setStyle(t,n,l)}function a(e,t){var n,o,i=[];return t.mapSelection(function(r,a,s){a!=o&&(n=[],i.push(n),o=a);var l=t.getItem(a),u=l["$"+s];return n.push({text:r,math:u,style:e.getStyle(a,s)}),r}),i}t.__esModule=!0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};t.init=o;var l,u,c,d,f=n(37),h=n(60)},function(e,t,n){"use strict";function o(e){e.conditions={_empty:!0,_pull:{},handlers:{">":function(e,t){return e>t},"<":function(e,t){return t>e},"=":function(e,t){return e==t},"<>":function(e,t){return webix.isArray(t)&&e<t[1]&&e>t[0]}},add:v,remove:w,update:h,get:p,parse:d,serialize:m,clear:f},e.attachEvent("onConditionSet",function(t){return r(e,t)}),e.attachEvent("onUndo",function(t,n,o,i){"condition"==t&&a(e,n,o,i)}),e.attachEvent("onDataSerialize",function(t){return s(e,t)}),e.attachEvent("onDataParse",function(t){return l(e,t)}),e.attachEvent("onColumnInit",function(t){return u(e,t)}),e.attachEvent("onReset",function(){return e.conditions.clear()}),e.attachEvent("onBeforeStyleClear",function(t,n){var o=e.conditions.get(t,n);o&&e.callEvent("onBeforeConditionSet",[t,n,o,null])&&(e.conditions.remove(t,n),e.refresh())}),e.attachEvent("onAction",function(e,t){"before-grid-change"==e&&g(t.name,t.inc,t.data,t.start)}),i(e)}function i(e){e.conditions.clear()}function r(e,t){b.group.set(function(){e.eachSelectedCell(function(n){var o=e.conditions.get(n.row,n.column);e.callEvent("onBeforeConditionSet",[n.row,n.column,o||null,t,b.group.value])&&e.conditions.update(n.row,n.column,t)})}),e.refresh()}function a(e,t,n,o){e.conditions.get(t,n)&&e.conditions.remove(t,n),o&&e.conditions.update(t,n,o)}function s(e,t){t.conditions=e.conditions.serialize()}function l(e,t){e.conditions.parse(t.conditions)}function u(e,t){t.cssFormat=function(t,n,o,i){if(e.conditions._empty)return"";var r,a;if(r=e.conditions.get(o,i),!r)return"";for(a=r.length;a--;){var s=e.conditions.handlers[r[a][0]];if(s&&s(n[i],r[a][1]))return r[a][2]}return""}}function c(e,t,n,o){return o._empty=!1,e[t]||(e[t]={}),e[t][n]||(e[t][n]=[]),e[t][n]}function d(e){if(this._empty=!0,e)for(var t=e.length;t--;){var n=e[t],o=c(this._pull,n[0],n[1],this);o.push([n[2],n[3],n[4]])}}function f(){this._pull={}}function h(e,t,n){var o=this.get(e,t);o||c(this._pull,e,t,this),this._pull[e][t]=n}function p(e,t){return e?t?this._pull[e]?this._pull[e][t]:null:this._pull[e]:this._pull}function v(e,t,n,o,i){var r=c(this._pull,e,t,this);r.push([n,o,i])}function w(e,t){var n=this.get(e,t);n&&delete this._pull[e][t]}function m(){var e,t,n,o,i=[];for(o in this._pull)for(e in this._pull[o])for(n=0;n<this._pull[o][e].length;n++)t=this._pull[o][e][n],i.push([o,e,t[0],t[1],t[2]]);return i}function g(e,t,n,o){var i=n.conditions,r=i.length;if(t)for(;r--;){var a=i[r],s=a[0],l=a[1];("row"==e&&s>=o.row||"column"==e&&l>=o.column)&&(i[r][0]="row"==e?1*s+t:s,i[r][1]="column"==e?1*l+t:l)}}t.__esModule=!0,t.init=o;var b=n(37)},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){function t(t,o,i){var r=e.getRow(t);r[o]=d(i,c),n(t,o)}function n(e,n){var o=a[e];if(o){var i=o[n];if(i)for(var r=0;r<i.length;r++){var s=i[r];if(w++,w>100)return;t(s.row,s.column,s.handler),w--}}}function o(){var t=e.$$("cells"),n=t.getState(),o=n.ids.concat(n.hidden);t.eachRow(function(e){for(var t=this.getItem(e),n=1;n<o.length;n++){var r=o[n],a=t["$"+r];a&&i(e,r,a)}},!0),t.refresh()}function i(t,o,i){var f=u[t];if(f&&f[o]&&s(a,u,o,t),i&&0===i.toString().indexOf("=")){var h=l(i,c),p=e.getRow(t);p[o]=d(h.handler,c),p["$"+o]=i,h.triggers.length&&r(a,u,h.triggers,{
row:t,column:o,handler:h.handler})}w=0,n(t,o)}var a=[],u=[],c=f(e);e.ranges=c.ranges=new b.Ranges(e),c.p=x.init(e),e.attachEvent("onReset",function(){a=[],u=[],e.ranges.clear()}),e.attachEvent("onCellChange",i),e.attachEvent("onMathRefresh",o),e.attachEvent("onDataSerialize",function(t){return h(e,t)}),e.attachEvent("onDataParse",function(t){return p(e,t)}),e.attachEvent("onAction",function(e,t){"before-grid-change"==e&&v(t.name,t.inc,t.data,t.start)});var w}function r(e,t,n,o){for(var i=[],r=0;r<n.length;r++)for(var s=n[r],l=s[0];l<=s[2];l++){var u=e[l];u||(u=e[l]=[]);for(var c=s[1];c<=s[3];c++){var d=u[c];d||(d=u[c]=[]),i.push([l,c]),d.push(o)}}a(t,o.row,o.column,i)}function a(e,t,n,o){var i=e[t];i||(i=e[t]=[]),i[n]=o}function s(e,t,n,o){var i=t[o][n];t[o][n]=null;for(var r=i.length-1;r>=0;r--)for(var a=i[r],s=e[a[0]][a[1]],l=s.length-1;l>=0;l--){var u=s[l];u.row==o&&u.column==n&&s.splice(l,1)}}function l(e,t){var n=C.parse(e,t);return n.handler=c(n.code),n}function u(){return"ERROR"}function c(e){try{return new Function(e)}catch(t){return u}}function d(e,t){var n;try{n=e.call(t)}catch(o){return"ERROR"}return"number"==typeof n?Math.round(1e5*n)/1e5:n}function f(e){return{r:function(t,n,o,i){for(var r=[],a=t;o>=a;a++)for(var s=e.getRow(a),l=n;i>=l;l++)r.push(s[l]);return r},v:function(t,n){var o=e.getRow(t)[n];return o||0===o?1*o:""},m:m,p:{}}}function h(e,t){t.ranges=e.ranges.serialize()}function p(e,t){e.ranges.parse(t.ranges)}function v(e,t,n,o){for(var i=n.ranges,r=0;r<i.length;r++)i[r][1]=(0,$.changeRange)(i[r][1],e,t,o)}t.__esModule=!0,t.init=i;var w=n(42),m=o(w),g=n(49),b=o(g),_=n(65),x=o(_),y=n(61),C=o(y),$=n(39)},function(e,t){"use strict";function n(e){var t={};return e.setPlaceholder=function(n,i){if("object"===("undefined"==typeof n?"undefined":o(n)))for(var r in n)t[r.toLowerCase()]=n[r];else t[n.toString().toLowerCase()]=i;e.callEvent("onMathRefresh",[])},t}t.__esModule=!0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};t.init=n},function(e,t){"use strict";function n(e){e.attachEvent("onDataParse",function(t){return i(e,t)}),e.attachEvent("onDataSerialize",function(t,n){return o(e,t,n)}),e.attachEvent("onUndo",function(t,n,o,i){"value"==t&&r(e,n,o,i)})}function o(e,t,n){var o=!n||n.math!==!1,i=[],r=e.$$("cells"),a=r.getState(),s=a.ids.concat(a.hidden),l=s.indexOf("rowId");l>-1&&s.splice(l,1),r.eachRow(function(e){for(var t=this.getItem(e),n=0;n<s.length;n++){var r=s[n],a=t[r],l=t.$cellCss?t.$cellCss[r]||"":"";(""!==a&&"undefined"!=typeof a||l)&&(o&&(a=t["$"+r]||a),i.push([1*e,1*r,a||"",l]))}},!0),t.table={frozenColumns:r.config.leftSplit-1,frozenRows:r.config.topSplit},t.data=i}function i(e,t){var n=e.$$("cells"),o=t.table;o&&(webix.isUndefined(o.frozenColumns)||o.frozenColumns+1==n.config.leftSplit||e.freezeColumns(o.frozenColumns),webix.isUndefined(o.frozenRows)||o.frozenRows==n.config.topSplit||e.freezeRows(o.frozenRows)),t.sizes&&n.define("fixedRowHeight",!1);for(var i=0;i<t.data.length;i++){var r=t.data[i],a=r[0],s=r[1],l=r[2],u=r[3],c=n.getItem(a);c[s]=l,u&&(c.$cellCss=c.$cellCss||{},c.$cellCss[s]=u),e.callEvent("onCellChange",[a,s,l])}}function r(e,t,n,o){e.setCellValue(t,n,o)}t.__esModule=!0,t.init=n},function(e,t,n){"use strict";function o(e){var t=e._table;e.attachEvent("onReset",function(){return i(e)}),i(e),t.attachEvent("onBeforeEditStart",function(t){var n=this.getColumnConfig(t.column);if(this._ssEditors[t.row]){var o=this._ssEditors[t.row][t.column];o&&(webix.extend(n,o,!0),o.options&&"string"==typeof o.options&&(n.options=(0,c.rangeValue)(e,o.options,{unique:!0,empty:!0,order:!0})))}}),t.attachEvent("onAfterEditStop",function(t,n){if(this.getColumnConfig(n.column).editor="text",this._ss_filters.length)for(var o=0;o<this._ss_filters.length;o++){var i=this._ss_filters[o];if(i[0]==n.row&&i[1]==n.column)return e.filterSpreadSheet()}}),t.on_click.ss_filter=function(e,t){this.edit(t)},e.attachEvent("onAction",function(e,t){"before-grid-change"==e&&u(t.name,t.inc,t.data,t.start)})}function i(e){e._table._ssEditors={},e._table._ss_filters=[]}function r(e,t){var n,o,i=e._table._ssEditors,r=[];for(n in i)for(o in i[n])s(e,n,o)||r.push([n,o,i[n][o]]);t.editors=r}function a(e,t){var n,o=t.editors;if(o)for(n=0;n<o.length;n++)e.setCellEditor.apply(e,o[n])}function s(e,t,n){var o,i=!1,r=e._table._ss_filters;for(o=0;!i&&o<r.length;o++)r[o][0]==t&&r[o][1]==n&&(i=!0);return i}function l(e,t,n){e._table._ss_filters.push([t,n]),e.callEvent("onAction",["addFilter",{row:t,column:n}]),e.setCellValue(t,n,"")}function u(e,t,n,o){var i=void 0,r=n.editors;if(t)for(i=r.length-1;i>=0;i--){var a=r[i],s=a[0],l=a[1],u=a[2];("row"==e&&s>=o.row||"column"==e&&l>=o.column)&&(u=webix.copy(u),r[i][0]="row"==e?1*s+t:s,r[i][1]="column"==e?1*l+t:l,r[i][2]=u),u.options=(0,d.changeRange)(u.options,e,t,o)}}t.__esModule=!0,t.init=o,t.serialize=r,t.load=a,t.addCellFilter=l;var c=n(49),d=n(39)},function(e,t,n){(function(e){"use strict";function n(t){t.attachEvent("onCommand",function(n){if("show"==n.id||"hide"==n.id){var o=t._table.getSelectArea();o&&e(n,o.start,o.end,t)}}),o(t),t.attachEvent("onUndo",function(n,o,i,r,a){if(!("hide"!=n.id&&"show"!=n.id||"column"!=n.group&&"row"!=n.group)){var s=n.id;a||(s="hide"==s?"show":"hide");var l=o||i;e({id:s,group:n.group},l.start,l.end,t,!0)}}),t.attachEvent("onHardReset",function(){return o(t)}),t.attachEvent("onAction",function(e,n){"before-grid-change"==e&&v(t,n.name,n.inc,n.data,n.start)})}function o(e,t){t?e["_hidden_"+t+"_hash"]={}:(e._hidden_cols_hash={},e._hidden_rows_hash={})}function i(e){return webix.isArray(e)?e:[e,e]}function r(e,t,n){if(t){var o=i(t);if(e._hidden_cols_hash[o[0]]||!webix.isUndefined(n)&&!n){if(e._hidden_cols_hash[o[0]]&&(webix.isUndefined(n)||!n)){var r=o[0]>1?1:-1;d({id:"show",group:"column"},{column:o[0]+r},{column:o[1]+r},e)}}else h({id:"hide",group:"column"},{column:o[0]},{column:o[1]},e)}else{var a=e.getSelectedId(!0),s={id:n===!1?"show":"hide",group:"column"};a.length&&e.callEvent("onCommand",[s,a[0],a[a.length-1]])}}function a(e,t){return!e._hidden_cols_hash[t]}function s(e,t,n){if(t){var o=i(t);if(e._hidden_rows_hash[o[0]]||!webix.isUndefined(n)&&!n){if(e._hidden_rows_hash[o[0]]&&(webix.isUndefined(n)||!n)){var r=o[0]>1?1:-1;f({id:"show",group:"row"},{row:o[0]+r},{row:o[1]+r},e)}}else p({id:"hide",group:"row"},{row:o[0]},{row:o[1]},e)}else{var a=e.getSelectedId(!0),s={id:n===!1?"show":"hide",group:"row"};a.length&&e.callEvent("onCommand",[s,a[0],a[a.length-1]])}}function l(e,t){return!e._hidden_rows_hash[t]}function u(e,t){var n=[],o=[];for(var i in e._hidden_rows_hash)n.push(i);for(var r in e._hidden_cols_hash)o.push(r);(n.length||o.length)&&(t.table.hidden={}),n.length&&(t.table.hidden.row=n),o.length&&(t.table.hidden.column=o)}function c(e,t){if(!webix.isUndefined(t.table)&&!webix.isUndefined(t.table.hidden)){var n=t.table.hidden;if(n.row&&n.row.length)for(var o=0;o<n.row.length;o++)p({id:"hide",group:"row"},{row:n.row[o]},{row:n.row[o]},e,!0);if(n.column&&n.column.length)for(var i=0;i<n.column.length;i++)h({id:"hide",group:"column"},{column:n.column[i]},{column:n.column[i]},e,!0)}}function e(e,t,n,o,i){"column"==e.group?"show"==e.id?d.apply(this,arguments):"hide"==e.id&&h.apply(this,arguments):"row"==e.group&&("show"==e.id?f.apply(this,arguments):"hide"==e.id&&p.apply(this,arguments))}function d(e,t,n,o,i){for(var r=n.column;r>=t.column;){var a=r;if(i||(a=o._hidden_cols_hash[1*r-1]||o._hidden_cols_hash[1*r+1]||!1),a!==!1){delete o._hidden_cols_hash[a];var s=o.$$("cells").getColumnConfig(a-1||"rowId").header[0];s.css=s.css.replace("webix_ssheet_hide_column",""),o.$$("cells").showColumn(a),t.column=t.column<a?t.column:a,n.column=n.column>a?n.column:a,i||o.callEvent("onColumnChange",[e,{column:a},{column:a},null])}r--}}function f(e,t,n,o,i){for(var r=n.row;r>=t.row;){var a=r;if(i||(a=o._hidden_rows_hash[1*r-1]||o._hidden_rows_hash[1*r+1]||!1),a!==!1){if(delete o._hidden_rows_hash[a],a-1===0){var s=o.$$("cells").getColumnConfig("rowId").header[0];s.css=s.css.replace("webix_ssheet_hide_row",""),o.$$("cells").refreshColumns()}else o.$$("cells").removeCellCss(a-1,"rowId","webix_ssheet_hide_row");i||o.callEvent("onRowChange",[e,{row:a},{row:a},null])}r--}o.$$("cells").filter(function(e){return!o._hidden_rows_hash[e.id]})}function h(e,t,n,o,i){var r=n.column;for(o.$handleSelection=null,o.$$("cells").removeSelectArea();r>=t.column;){o._hidden_cols_hash[r]=r;var a=o.$$("cells").getColumnConfig(r-1||"rowId").header[0];a.css=(a.css||"")+" webix_ssheet_hide_column",o.$$("cells").hideColumn(r),r--}i||o.callEvent("onColumnChange",[e,t,n,null])}function p(e,t,n,o,i){for(var r=n.row;r>=t.row;){if(o._hidden_rows_hash[r]=r,r-1===0){var a=o.$$("cells").getColumnConfig("rowId").header[0];a.css=(a.css||"")+" webix_ssheet_hide_row",o.$$("cells").refreshColumns()}else o.$$("cells").addCellCss(r-1,"rowId","webix_ssheet_hide_row");r--}o.$$("cells").filter(function(e){return!o._hidden_rows_hash[e.id]}),i||o.callEvent("onRowChange",[e,t,n,null])}function v(e,t,n,i,r){if(i.table&&i.table.hidden&&i.table.hidden[t]&&i.table.hidden[t].length){"column"===t&&o(e,"cols"),"row"===t&&o(e,"rows");var a=r[t],s=a+n;if(a>s){var l=[s,a];a=l[0],s=l[1]}for(var u=a;s>u;u++)for(var c=0;c<i.table.hidden[t].length;c++)i.table.hidden[t][c]>=u&&(i.table.hidden[t][c]=1*i.table.hidden[t][c]+(n>0?1:-1))}}t.__esModule=!0,t.init=n,t.reset=o,t.setColumnState=r,t.isColumnVisible=a,t.setRowState=s,t.isRowVisible=l,t.serialize=u,t.load=c}).call(t,n(59))},function(e,t,n){"use strict";function o(e){if(e.config.resizeCell){var t=e.$$("cells");t.define("resizeRow",{headerOnly:!0,size:10}),t.define("resizeColumn",{headerOnly:!0,size:10}),t.define("fixedRowHeight",!1),t.attachEvent("onRowResize",function(t){e.$$("cells").removeSelectArea(),e._save("sizes",{row:t,column:0,size:e.getRow(t).$height})}),t.attachEvent("onColumnResize",function(t){e.$$("cells").removeSelectArea(),e._save("sizes",{row:0,column:t,size:e.getColumn(t).width})}),e.attachEvent("onUndo",function(t,n,o,r){"c-resize"!=t&&"r-resize"!=t||i(e,n,o,r)})}e.attachEvent("onDataParse",function(t){if(t.sizes){for(var n=0;n<t.sizes.length;n++){var o=t.sizes[n];1*o[0]!==0?e.getRow(o[0]).$height=1*o[2]:e.getColumn(o[1]).width=1*o[2]}t.sizes.length&&e.refresh(!0)}}),e.attachEvent("onDataSerialize",function(t){for(var n=[],o=e.$$("cells"),i=o.config.columns,r=o.data.order,a=o.config.columnWidth,s=o.config.rowHeight,l=1;l<i.length;l++){var u=i[l].width;u&&u!=a&&n.push([0,l,u])}for(var l=0;l<r.length;l++){var c=o.getItem(r[l]).$height;c&&c!=s&&n.push([1*r[l],0,c])}t.sizes=n}),e.attachEvent("onAction",function(e,t){"before-grid-change"==e&&r(t.name,t.inc,t.data,t.start)}),e.attachEvent("onStyleChange",a),e.attachEvent("onCellChange",a)}function i(e,t,n,o){t?(e.$$("cells").getItem(t).$height=o,e._save("sizes",{row:t,column:0,size:o})):e._table.setColumnWidth(n,o),(0,s.updateSelectAreas)(e)}function r(e,t,n,o){var i=void 0,r=n.sizes;if(t)for(i=r.length-1;i>=0;i--){var a=r[i],s=a[0],l=a[1];(s&&"row"==e&&s>=o.row||l&&"column"==e&&l>=o.column)&&(r[i][0]="row"==e?1*s+t:s,r[i][1]="column"==e?1*l+t:l)}}function a(e,t){var n=this,o=(0,l.getStyle)(n,{row:e,column:t});o&&"wrap"===o.props.wrap&&!function(){var t=n._table.getItem(e),o=t.$height||n._table.config.rowHeight;n._table.eachColumn(function(t,i){var r=(0,l.getStyle)(n,{row:e,column:t});if(r&&r.props&&"wrap"===r.props.wrap){var a=this.getText(e,t);o=Math.max(o,(0,l.getTextSize)(n,a,r.id,i.width).height)}}),t.$height=o}()}t.__esModule=!0,t.init=o;var s=n(34),l=n(36)},function(e,t,n){"use strict";function o(e){var t=e._table;t.attachEvent("onBeforeAreaRemove",function(){return e.$handleSelection?!1:void 0}),t.attachEvent("onBeforeAreaAdd",function(n){if(t.editStop(),!e.$handleSelection)return!0;var o=i.encode[n.start.column]+n.start.row,r=i.encode[n.end.column]+n.end.row,a=e.$handleSelection(n.start,n.end,o,r);return a!==!1&&(e.$handleSelection=null,t.removeSelectArea()),a}),webix.event(t.$view,"mousedown",function(t){return e.$handleSelection?webix.html.preventEvent(t):void 0})}t.__esModule=!0,t.init=o;var i=n(39)},function(e,t,n){"use strict";function o(e){e.attachEvent("onCommand",function(t){"sort-asc"!==t.id&&"sort-desc"!==t.id||i(e,null,t.id.replace("sort-",""))})}function i(e,t,n,o){t=t||e._table.getSelectArea(),t&&!function(){t=(0,l.rangeObj)(t,e);var i=t;t.start.row===t.end.row&&(i=(0,a.expandSelection)(t,e));var s=e.getCellValue(t.start.row,t.start.column);o=o||(isNaN(parseFloat(s))?"str":"int"),n=n&&"asc"!==n?-1:1,u.group.set(function(){return r(i,t.start.column,o,n,e)})}()}function r(e,t,n,o,i){for(var r=e.start.column;r<=e.end.column;r++){for(var a=[],l=e.start.row;l<=e.end.row;l++){var u=i.getRow(l),d=u[r],f=i.getStyle(l,r),h=u["$"+r];a.push({value:d,style:f,math:h,row:l})}a.sort(c[n](o,"value"));for(var l=e.start.row;l<=e.end.row;l++){var p=a.shift();if(i.setStyle(l,r,p.style||null),p.math){var v={id:"move",row:l-p.row,column:0},w=(0,s.updateMath)(p.math,v);i.setCellValue(l,r,w)}else i.setCellValue(l,r,p.value)}}i.refresh()}t.__esModule=!0,t.init=o,t.sortRange=i;var a=n(72),s=n(60),l=n(39),u=n(37),c={"int":function(e,t){return function(n,o){var i=parseFloat(n[t])||-(1/0),r=parseFloat(o[t])||-(1/0);return(i>r?1:i==r?0:-1)*e}},str:function(e,t){return function(n,o){var i=(n[t]||"").toString().toLowerCase(),r=(o[t]||"").toString().toLowerCase();return(i>r?1:i==r?0:-1)*e}}}},function(e,t){"use strict";function n(e,t){for(var n=t.config.rowCount,i=t.config.columnCount,r=t._table,a=e.start.row,s=e.end.row,l=e.start.column,u=e.end.column,c=a-1;c>0&&o(c,e.start.column,r);c--)a=c;for(var c=s+1;n>c&&o(c,e.end.column,r);c++)s=c;for(var c=l-1;c>0&&o(e.start.row,c,r);c--)l=c;for(var c=u+1;i>c&&o(e.end.row,c,r);c++)u=c;var d={start:{row:a,column:l},end:{row:s,column:u}};return a==e.start.row&&s==e.end.row&&l==e.start.column&&u==e.end.column||t._table.addSelectArea(d.start,d.end),d}function o(e,t,n){var o=n.getItem(e)[t];return void 0!==o&&""!==o}t.__esModule=!0,t.expandSelection=n},function(e,t,n){"use strict";function o(e){e.attachEvent("onStyleChange",function(t,n,o){var r=i(e,t,n);r&&(r[3]=o?o.id:"")}),e.attachEvent("onDataParse",function(t){if(t.spans)for(var n=0;n<t.spans.length;n++){var o=t.spans[n];r(e,{row:o[0],column:o[1]},1*o[2],1*o[3])}}),e.attachEvent("onDataSerialize",function(t){var n=[],o=e.$$("cells").getSpan();if(o){for(var i in o){var r=o[i];for(var a in r){var s=r[a];n.push([1*i,1*a,s[0],s[1]])}}t.spans=n}}),e.attachEvent("onUndo",function(t,n,o,i,r){"span"!=t&&"split"!=t||("span"==t&&(r=!r),l(e,n,o,i,r))}),e.attachEvent("onAction",function(t,n){if("lock"==t)u(e,n.row,n.column,n.newValue);else if("before-grid-change"==t)c(n.name,n.inc,n.data,n.start);else if("check-borders"==t)return d(e,n.row,n.column,n.area,n.mode)})}function i(e,t,n){var o=e.$$("cells").getSpan()[t];return o?o[n]:void 0}function r(e,t,n,o){if(!(2>n&&2>o)){var i=e.getRow(t.row),r=i.$cellCss?i.$cellCss[t.column]||"":"";f(e,t,n,o),e.$$("cells").addSpan(t.row,t.column,n,o,null,r),e._save("spans",{row:t.row,column:t.column,x:n,y:o})}}function a(e,t){e.$$("cells").removeSpan(t.row,t.column),e._save("spans",{row:t.row,column:t.column,x:0,y:0})}function s(e){var t,n,o,i;o=i=0,t=n=1/0;for(var r=0;r<e.length;r++){var a=1*e[r].column,s=1*e[r].row;t=Math.min(a,t),o=Math.max(a,o),n=Math.min(s,n),i=Math.max(s,i)}return{cell:{row:n,column:t},x:o-t+1,y:i-n+1}}function l(e,t,n,o,i){i?a(e,{row:t,column:n}):r(e,{row:t,column:n},o[0],o[1])}function u(e,t,n,o){var r=i(e,t,n);r&&(o?-1==r[3].indexOf(h.lockCss)&&(r[3]+=" "+h.lockCss):r[3]=r[3].replace(" "+h.lockCss,""),e._table.refresh())}function c(e,t,n,o){var i=void 0,r=n.spans;if(t)for(i=r.length-1;i>=0;i--){var a=r[i],s=a[0],l=a[1];a[2],a[3];("row"==e&&s>=o.row||"column"==e&&l>=o.column)&&(r[i][0]="row"==e?1*s+t:s,r[i][1]="column"==e?1*l+t:l)}}function d(e,t,n,o,r){var a=i(e,t,n);return a&&p[r]?p[r](t,n,a,o):!1}function f(e,t,n,o){var i,r,a,s=1*t.row,l=1*t.column,u=!e.getCellValue(s,l);for(i=s;s+o>i;i++)for(r=l;l+n>r;r++)a=e.getCellValue(i,r),""===a||r==l&&i==s||(u&&(u=!1,e.setCellValue(s,l,a)),e.setCellValue(i,r,""))}t.__esModule=!0,t.init=o,t.addSpan=r,t.removeSpan=a,t.getRange=s;var h=n(38),p={"border-right":function(e,t,n,o){return o.end.column==t+n[0]-1},"border-bottom":function(e,t,n,o){return o.end.row==e+n[1]-1}}},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){var t=[a,l,c,f,p,w,g];e.attachEvent("onDataSerialize",function(n){for(var o=0;o<t.length;o++)t[o].serialize&&t[o].serialize(e,n)}),e.attachEvent("onDataParse",function(n){for(var o=0;o<t.length;o++)t[o].load&&t[o].load(e,n)})}t.__esModule=!0,t.init=i;var r=n(75),a=o(r),s=n(76),l=o(s),u=n(38),c=o(u),d=n(67),f=o(d),h=n(77),p=o(h),v=n(32),w=o(v),m=n(68),g=o(m)},function(e,t){"use strict";function n(e,t){var n=e.$$("cells"),o=-1!=n.$view.className.indexOf("webix_borderless");o||!webix.isUndefined(t)&&!t?!o||!webix.isUndefined(t)&&t||webix.html.removeCss(n.$view,"webix_borderless"):webix.html.addCss(n.$view,"webix_borderless",!0)}function o(e,t){t.table.gridlines=-1!=e.$$("cells").$view.className.indexOf("webix_borderless")?0:1}function i(e,t){webix.isUndefined(t.table)||webix.isUndefined(t.table.gridlines)||n(e,!t.table.gridlines)}t.__esModule=!0,t.hideGridlines=n,t.serialize=o,t.load=i},function(e,t){"use strict";function n(e,t){var n=e.$$("cells");n.config.header&&(webix.isUndefined(t)||t)?(n.hideColumn("rowId"),n.config.header=!1,n.refreshColumns()):n.config.header||!webix.isUndefined(t)&&t||(n.showColumn("rowId"),n.config.header=!0,n.refreshColumns())}function o(e,t){t.table.headers=e.$$("cells").config.header?1:0}function i(e,t){webix.isUndefined(t.table)||webix.isUndefined(t.table.headers)||n(e,!t.table.headers)}t.__esModule=!0,t.hideHeaders=n,t.serialize=o,t.load=i},function(e,t,n){"use strict";function o(e){e.attachEvent("onCommand",function(t){"create-filter"===t.id&&a(e)}),e.attachEvent("onUndo",function(t,n,o,i){"filter"===t?i?a(e,i):e.removeFilter():"dropdown"==t&&e.setCellEditor(n,o,i)}),e.attachEvent("onAction",function(e,t){"before-grid-change"==e&&s(t.name,t.inc,t.data,t.start)})}function i(e,t){var n,o=e._table._ssEditors,i=e._table._ss_filters,r=[];for(n=0;n<i.length;n++){var a=i[n],s=a[0],l=a[1],u=o[s][l].options;u&&r.push([s,l,u])}t.filters=r}function r(e,t){var n,o=t.filters;if(o)for(n=0;n<o.length;n++)e.setCellFilter.apply(e,o[n])}function a(e,t){if(t=t||e._table.getSelectArea(),e.removeFilter(),t){l.group.start();for(var n=t.start.column;n<=t.end.column;n++){var o=t.start.row,i=(0,u.toRange)(o+1,n,t.end.row,n);e.setCellFilter(o,n,i),e.callEvent("onAction",["filter",{row:o,column:n,value:null,newValue:t}])}l.group.end()}}function s(e,t,n,o){var i=void 0,r=n.filters;if(t)for(i=r.length-1;i>=0;i--){var a=r[i],s=a[0],l=a[1],c=a[2];("row"==e&&s>=o.row||"column"==e&&l>=o.column)&&(r[i][0]="row"==e?1*s+t:s,r[i][1]="column"==e?1*l+t:l,r[i][2]=(0,u.changeRange)(c,e,t,o))}}t.__esModule=!0,t.init=o,t.serialize=i,t.load=r;var l=n(37),u=n(39)},function(e,t){"use strict";function n(e){var t;window.XMLHttpRequest&&(new XMLHttpRequest).upload&&(t=webix.ui({view:"uploader",apiOnly:!0}),t.attachEvent("onBeforeFileAdd",webix.bind(function(t){return e.reset(),e.parse(t.file,"excel"),!1},this))),e.attachEvent("onCommand",function(n){"excel-import"===n.id&&o(e,t)})}function o(e,t){t?webix.delay(function(){return t.fileDialog()}):webix.alert(webix.i18n.spreadsheet.labels["import-not-support"])}t.__esModule=!0,t.init=n},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){for(var t=[a,l,c,f,p,w,g,_,y,$,E,k,I,A],n=0;n<t.length;n++)webix.extend(e,t[n])}t.__esModule=!0,t.api=i;var r=n(80),a=o(r),s=n(81),l=o(s),u=n(82),c=o(u),d=n(83),f=o(d),h=n(84),p=o(h),v=n(85),w=o(v),m=n(86),g=o(m),b=n(87),_=o(b),x=n(88),y=o(x),C=n(89),$=o(C),S=n(90),E=o(S),V=n(91),k=o(V),M=n(92),I=o(M),R=n(93),A=o(R)},function(e,t){"use strict";function n(e){s(this,"add","row",e)}function o(e){s(this,"del","row",e)}function i(e){s(this,"add","column",e)}function r(e){s(this,"del","column",e)}function a(e,t,n){if(t)webix.isArray(t)||(t=[t,t]);else{var o=e.$$("cells").getSelectArea();o&&(t=[o.start[n],o.end[n]])}return t}function s(e,t,n,o){var i={},r={};o=a(e,o,n),i[n]=o[0],r[n]=o[1],e.callEvent("onCommand",[{id:t,group:n},i,r])}t.__esModule=!0,t.insertRow=n,t.deleteRow=o,t.insertColumn=i,t.deleteColumn=r},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t,n){s.lockCell(this,e,t,n)}function r(e,t){return s.isCellLocked(this,e,t)}t.__esModule=!0,t.lockCell=i,t.isCellLocked=r;var a=n(38),s=o(a)},function(e,t){"use strict";function n(e){var t=this.$$("cells"),n=t.config.leftSplit-1;if(e===!1&&(e=0),webix.isUndefined(e)){var o=this.getSelectedId(!0);e=o.length?o[0].column:0}if(t.config.leftSplit>1){var i=e-n;i||(e=0)}t.unselect(),t.define("leftSplit",e?e+1:1),t.refreshColumns(),this.callEvent("onAction",["freeze-column",{value:n,newValue:e}])}function o(e){var t=this.$$("cells"),n=t.config.topSplit;n==e&&(e=0),t.unselect(),t.define("topSplit",e||0),t.refreshColumns(),this.callEvent("onAction",["freeze-row",{value:n,newValue:e}])}t.__esModule=!0,t.freezeColumns=n,t.freezeRows=o},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){a.hideGridlines(this,e)}t.__esModule=!0,t.hideGridlines=i;var r=n(75),a=o(r)},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){a.hideHeaders(this,e)}t.__esModule=!0,t.hideHeaders=i;var r=n(76),a=o(r)},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t){u.setColumnState(this,e,t)}function r(e){return u.isColumnHidden(this,e)}function a(e,t){u.setRowState(this,e,t)}function s(e){return u.isRowHidden(this,e)}t.__esModule=!0,t.hideColumn=i,t.isColumnVisible=r,t.hideRow=a,t.isRowVisible=s;var l=n(68),u=o(l)},function(e,t){"use strict";function n(e,t,n){var i=o(n);this.setCellValue(e,t,i),this.refresh()}function o(e){var t="=SPARKLINE("+e.range+',"'+e.type+'"';return"bar"===e.type?t+=',"'+e.color+'","'+e.negativeColor+'"':e.color&&(t+=',"'+e.color+'"'),t+")"}t.__esModule=!0,t.addSparkline=n},function(e,t){"use strict";function n(e,t,n){this.setCellValue(e,t,'=IMAGE("'+n+'")'),this.callEvent("onStyleSet",["format","image"])}t.__esModule=!0,t.addImage=n},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){var t=this;if(!e){var n=this.getSelectedId(!0);n.length>1&&(e=E.getRange(n))}k.group.set(function(){e&&t.callEvent("onBeforeSpan",[e.cell.row,e.cell.column,[e.x,e.y]])&&E.addSpan(t,e.cell,e.x,e.y)}),this.refresh()}function r(e,t){e&&t?E.removeSpan(this,{row:e,column:t}):k.group.set(function(){this.eachSelectedCell(function(e){var t=this._table.getSpan(e.row,e.column);t&&this.callEvent("onBeforeSplit",[e.row,e.column,[t[2],t[3]],k.group.value])&&E.removeSpan(this,e)})},this),this.refresh()}function a(e,t){return I.addStyle(this,e,t)}function s(e,t){return I.getStyle(this,{row:e,column:t})}function l(e,t,n){return I.setStyle(this,{row:e,column:t},n)}function u(e,t){k.group.set(function(){I.setRangeStyle(this,e,t)},this)}function c(e,t){(e||(e=this._table.getSelectArea()))&&(t||(t={styles:!0,values:!0}),t.styles&&I.clearRangeStyle(this,e),t.values&&this.setRangeValue(e,null),this.refresh())}function d(e,t,n){var o=this.getStyle(e,t),i=A.addFormat(n),r=I.addStyle(this,{format:i},o);this.setStyle(e,t,r)}function f(e){var t={};return this.callEvent("onDataSerialize",[t,e]),e&&e.sheets?$.serialize(this,t):t}function h(e){$.show(this,e)}function p(){return this._activeSheet}function v(e){$.add(this,e)}function w(){$.clear(this)}function m(e,t){$.rename(this,e,t)}function g(e){$.edit(this,e)}function b(e){$.remove(this,e)}function _(){k.undo(this)}function x(){k.redo(this)}function y(e,t){z.sortRange(this,e,t)}t.__esModule=!0,t.combineCells=i,t.splitCell=r,t.addStyle=a,t.getStyle=s,t.setStyle=l,t.setRangeStyle=u,t.clearRange=c,t.setFormat=d,t.serialize=f,t.showSheet=h,t.getActiveSheet=p,t.addSheet=v,t.clearSheet=w,t.renameSheet=m,t.editSheet=g,t.removeSheet=b,t.undo=_,t.redo=x,t.sortRange=y;var C=n(43),$=o(C),S=n(73),E=o(S),V=n(37),k=o(V),M=n(36),I=o(M),R=n(32),A=o(R),O=n(71),z=o(O)},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){e?this._table.refreshColumns():this._table.refresh()}function r(e){for(var t=this.getSelectedId(!0),n=0;n<t.length;n++)e.call(this,t[n])}function a(){var e=this._table.getSelectArea();return e?v.encode[e.start.column]+e.start.row+":"+v.encode[e.end.column]+e.end.row:""}function s(e){var t=this._table.getSelectArea();if(!e)return t&&t.start.row?t.start:null;var n=[];if(t)for(var o=t.start,i=t.end,r=o.row;r<=i.row;r++)for(var a=o.column;a<=i.column;a++)n.push({row:r,column:a});return n}function l(e,t){var n=this.getRow(e),o=n["$"+t]||n[t];return"undefined"==typeof o?"":o}function u(e,t,n){var o=this.getRow(e),i=o["$"+t]||o[t];this.callEvent("onBeforeValueChange",[e,t,n,i])&&(o[t]=n,delete o["$"+t],this.callEvent("onCellChange",[e,t,n,!0]),this.saveCell(e,t))}function c(e,t){g.group.set(function(){for(var n=(0,v.rangeObj)(e,this),o=n.start.row;o<=n.end.row;o++)for(var i=n.start.column;i<=n.end.column;i++)this.setCellValue(o,i,t)},this)}function d(e){return this._table.getItem(e)}function f(e){return this._table.getColumnConfig(e)}function h(e){this.callEvent("onReset",[e])}function p(){m.reset(this)}t.__esModule=!0,t.refresh=i,t.eachSelectedCell=r,t.getSelectedRange=a,t.getSelectedId=s,t.getCellValue=l,t.setCellValue=u,t.setRangeValue=c,t.getRow=d,t.getColumn=f,t.reset=h,t._resetTable=p;var v=n(39),w=n(34),m=o(w),g=n(37)},function(e,t){"use strict";function n(e,t){var n=this.config.save,o="";"string"==typeof n?o=n+"/"+e:n&&n[e]&&(o=n[e]),o&&(o.$proxy&&o.save?o.save(this,t,null,null):webix.ajax().post(o,t))}function o(e,t){var n=this.getStyle(e,t);this._save("data",{row:e,column:t,value:this.getCellValue(e,t),style:n?n.id:""})}t.__esModule=!0,t._save=n,t.saveCell=o},function(e,t,n){"use strict";function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){return this._table.getItem(e)}function r(e,t,n){this.setCellEditor(e,t,{editor:"richselect",options:n}),this.addFilter(e,t)}function a(e,t,n){var o=this._table._ssEditors[e]=this._table._ssEditors[e]||{},i=o[t]||this._table.getItem(e)[t];o[t]=n,n&&n.editor?this._table.addCellCss(e,t,"ss_filter"):(delete this._table._ssEditors[e][t],this._table.removeCellCss(e,t,"ss_filter")),this.callEvent("onAction",["dropdown",{row:e,column:t,value:i,newValue:n}])}function s(e,t){var n=this._table._ssEditors[e]||{};return n[t]||null}function l(e,t){return f.addCellFilter(this,e,t)}function u(){for(var e=this._table._ss_filters,t=0;t<e.length;t++){var n=e[t],o=n[0],i=n[1],r=this.getCellEditor(o,i);this.setCellEditor(o,i,null),this._table.removeCellCss(o,i,"ss_filter"),this.callEvent("onAction",["filter",{row:o,column:i,value:r,newValue:null}])}this._table._ss_filters=[],this._table.data.filter(function(){return!0})}function c(){this._table.data.silent(function(){for(var e=this,t=function(){var t=e._table._ss_filters[n],r=t[0],a=t[1];o=e._table.getItem(r)[a],i=!1,e._table.data.filter(function(e){return o?1*e.id<=1*r?!0:(e[a]||"0"===e[a]||(i=!0),i||e[a]==o):!0},1,n)},n=0;n<this._table._ss_filters.length;n++){var o,i;t()}},this),this._table.refresh()}t.__esModule=!0,t.getRow=i,t.setCellFilter=r,t.setCellEditor=a,t.getCellEditor=s,t.addFilter=l,t.removeFilter=u,t.filterSpreadSheet=c;var d=n(67),f=o(d)},function(e,t){"use strict";function n(e){var t=this;webix.modalbox({type:"alert webix_ssheet_confirm",text:e.text,buttons:[webix.i18n.spreadsheet.labels.cancel,webix.i18n.spreadsheet.labels.ok],callback:function(n){e.callback.call(t,"0"!=n)}})}function o(e){webix.modalbox({type:"alert webix_ssheet_alert",text:e.text,buttons:[webix.i18n.spreadsheet.labels.ok]})}t.__esModule=!0,t.confirm=n,t.alert=o},function(e,t,n){"use strict";function o(){(0,i.reset)(this)}t.__esModule=!0,t.resetUndo=o;var i=n(37)},function(e,t){"use strict";function n(e){e.attachEvent("onComponentInit",function(){return o(e)});var t=e.config,n={view:"menu",borderless:!1,css:"webix_ssheet_menu",id:"menu",autowidth:!0,type:{height:40},data:a.getMenuData(webix.isArray(t.menu)?t.menu:r)};return e.callEvent("onViewInit",["menu",n]),n}function o(e){e.$$("menu")&&e.$$("menu").attachEvent("onMenuItemClick",function(t){return i(e,t)})}function i(e,t){e.callEvent("onMenuItemClick",[t])&&(s[t]?s[t](e):e.callEvent("onCommand",[{id:t}]))}t.__esModule=!0,t.init=n;var r=[{id:"file",submenu:[{id:"sheet",submenu:[{id:"new-sheet"},{id:"copy-sheet"},{id:"remove-sheet"}]},{id:"excel-import"},{id:"excel-export"}]},{id:"edit",submenu:[{id:"add-range"},{id:"add-dropdown"},{id:"add-link"},{id:"lock-cell"},{id:"conditional-format"},{id:"clear-styles"}]},{id:"insert",submenu:[{id:"add-image"},{id:"add-sparkline"}]},{id:"data",submenu:[{id:"sort",submenu:[{id:"sort-asc"},{id:"sort-desc"}]},{id:"create-filter"}]},{id:"view",submenu:[{id:"columns",submenu:[{id:"insert-column"},{id:"delete-column"},{id:"show-column"},{id:"hide-column"}]},{id:"rows",submenu:[{id:"insert-row"},{id:"delete-row"},{id:"show-row"},{id:"hide-row"}]},{$template:"Separator"},{id:"freeze-columns"},{id:"freeze-rows"},{id:"hide-gridlines"},{id:"hide-headers"}]}],a={getMenuData:function(e){var t;for(t=0;t<e.length;t++)"string"==typeof e[t]&&(e[t]={id:e[t]}),e[t].value||(e[t].value=webix.i18n.spreadsheet.menus[e[t].id]),e[t].submenu&&(e[t].submenu=this.getMenuData(e[t].submenu));return e}},s={undo:function(e){e.undo()},redo:function(e){e.redo()},"insert-column":function(e){e.insertColumn()},"delete-column":function(e){e.deleteColumn()},"show-column":function(e){e.hideColumn(null,!1)},"hide-column":function(e){e.hideColumn(null,!0)},"insert-row":function(e){e.insertRow()},"delete-row":function(e){e.deleteRow()},"show-row":function(e){e.hideRow(null,!1)},"hide-row":function(e){e.hideRow(null,!0)},"freeze-columns":function(e){e.freezeColumns()},"hide-gridlines":function(e){e.hideGridlines()},"hide-headers":function(e){e.hideHeaders()}}},function(e,t){"use strict";function n(e){var t=webix.i18n.spreadsheet.labels;return t[e]||e}function o(){return[{name:n("normal"),css:"webix_ssheet_condition_regular"},{name:n("neutral"),css:"webix_ssheet_condition_neutral"},{name:n("bad"),css:"webix_ssheet_condition_bad"},{name:n("good"),css:"webix_ssheet_condition_good"}]}t.__esModule=!0,t.getDefaultStyles=o},function(e,t){"use strict"}]);