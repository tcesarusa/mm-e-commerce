"use strict";function insert_at_caret(a,b){var c,d=document.getElementById(a),e=d.scrollTop,f=0,g=d.selectionStart||"0"===d.selectionStart?"ff":!!document.selection&&"ie";"ie"===g?(d.focus(),c=document.selection.createRange(),c.moveStart("character",-d.value.length),f=c.text.length):"ff"===g&&(f=d.selectionStart);var h=d.value.substring(0,f),i=d.value.substring(f,d.value.length);d.value=h+b+i,f+=b.length,"ie"===g?(d.focus(),c=document.selection.createRange(),c.moveStart("character",-d.value.length),c.moveStart("character",f),c.moveEnd("character",0),c.select()):"ff"===g&&(d.selectionStart=f,d.selectionEnd=f,d.focus()),d.scrollTop=e}function inject_email_template(a,b){$.each(b,function(b,c){b=b.replace("email_template_",""),c&&a.indexOf(b)>-1&&("body"===b?$("#"+b).html(c):$("#"+b).val(c))})}function update_email_template_preview(){$("#email-template-preview").contents().find("body").html($(".email-template-body").val())}function insert_html_tag(a,b){var c,d,e,f,g,h,i,j,k;switch(a){case"text-bold":c=["<b>","</b>"];break;case"text-italic":c=["<em>","</em>"];break;case"text-paragraph":c=["<p>","</p>"];break;case"text-h1":c=["<h1>","</h1>"];break;case"text-h2":c=["<h2>","</h2>"];break;case"text-h3":c=["<h3>","</h3>"];break;case"text-h4":c=["<h4>","</h4>"];break;case"text-code":c=["<code>","</code>"];break;case"text-hr":c=["<hr/>",""];break;case"text-css":c=["<style></style>",""]}return e=document.getElementById(b),void 0!==document.selection?(e.focus(),d=document.selection.createRange(),f=d.text):""!==e.selectionStart&&(g=e.selectionStart,h=e.selectionEnd,f=e.value.substring(g,h)),"text-css"===a?(i=c[0]+"\n\r"+e.value,$(e).val(i),update_email_template_preview(),!0):0===c[1].length?(insert_at_caret(b,c[0]),update_email_template_preview(),!0):void(f&&f.length?(j=c[0]+f+c[1],k=e.value.length,i=e.value.substring(0,g)+j+e.value.substring(h,k),$(e).val(i),update_email_template_preview()):(c=c[0]+c[1],insert_at_caret(b,c),update_email_template_preview()))}$(document).ready(function(){$.ajaxPrefilter(function(a){"post"!==a.type&&"POST"!==a.type&&"Post"!==a.type||(""===a.data?a.data+="?_ip_csrf="+Cookies.get("ip_csrf_cookie"):a.data+="&_ip_csrf="+Cookies.get("ip_csrf_cookie"))}),$(document).ajaxComplete(function(){$('[name="_ip_csrf"]').val(Cookies.get("ip_csrf_cookie"))});var a=$("#content"),b=$("html"),c=b.outerHeight(),d=$(".navbar").outerHeight(),e=$("#headerbar").outerHeight(),f=$("#submenu").outerHeight(),g=c-d-e-f;a.outerHeight()<g&&a.outerHeight(g),b.click(function(){$(".dropdown-menu:visible").not(".datepicker").removeAttr("style")}),$('[data-toggle="tooltip"]').tooltip(),$(".simple-select").select2();new Clipboard(".to-clipboard");$(".taggable").on("focus",function(){window.lastTaggableClicked=this}),$(".tag-select").select2().on("change",function(a){var b=$(a.currentTarget);return void 0!==window.lastTaggableClicked&&insert_at_caret(window.lastTaggableClicked.id,b.val()),b.val([]),!1}),$(".html-tag").click(function(){insert_html_tag($(this).data("tagType"),$(".email-template-body").attr("id"))});var h=$(".email-template-body").attr("id");$("#email_template_preview").empty()&&update_email_template_preview(),$(h).bind("input propertychange",function(){update_email_template_preview()}),$("#email-template-preview-reload").click(function(){update_email_template_preview()}),$(document).on("click",".ajax-loader",function(){$("#fullpage-loader").fadeIn(200),window.fullpageloaderTimeout=window.setTimeout(function(){$("#loader-error").fadeIn(200),$("#loader-icon").removeClass("fa-spin").addClass("text-danger")},1e4)}),$(document).on("click",".fullpage-loader-close",function(){$("#fullpage-loader").fadeOut(200),$("#loader-error").hide(),$("#loader-icon").addClass("fa-spin").removeClass("text-danger"),clearTimeout(window.fullpageloaderTimeout)});var i=$(".passwordmeter-input");i&&i.on("input",function(){var a=zxcvbn(i.val());$(".passmeter-2, .passmeter-3").hide(),4===a.score?$(".passmeter-2, .passmeter-3").show():3===a.score&&$(".passmeter-2").show()})});